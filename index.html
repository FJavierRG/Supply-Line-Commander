<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Supply Line Commander - Logística Militar</title>
    <link rel="icon" type="image/png" href="assets/sprites/ui/resources.png">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div id="game-container">
        <div id="main-game">
            <canvas id="game-canvas"></canvas>
            
            <!-- Slider de cámara horizontal -->
            <div id="camera-slider-container">
                <input type="range" id="camera-slider" min="0" max="100" value="0" step="1">
            </div>
            
            <div id="timer-display">
                <span id="timer">90s</span>
                <button id="pause-btn" title="Pausar/Reanudar">⏸️</button>
            </div>
            
            <!-- Indicador de currency para construir FOBs -->
            <div id="fob-currency-display">
                <canvas id="fob-currency-icon" width="24" height="24"></canvas>
                <span id="fob-currency-label">$</span>
                <span id="fob-currency-amount">0</span>
            </div>
            
            
            <button id="start-timer-btn" class="game-start-overlay-btn">
                Comenzar
            </button>
            
            
            
            
            <!-- Botones de desarrollo -->
            <button id="dev-supply-enemy-btn" style="position: absolute; top: 10px; right: 10px; padding: 8px 15px; background: rgba(139, 0, 0, 0.8); color: white; border: 2px solid #8b0000; border-radius: 5px; font-family: monospace; font-weight: bold; cursor: pointer; z-index: 1000; display: none;">
                ENEMIGO
            </button>
            
            <!-- Botón volver al editor (solo visible durante playtest) -->
            <button id="back-to-editor-btn" style="display: none; position: absolute; top: 10px; right: 130px; padding: 8px 15px; background: rgba(66, 133, 244, 0.9); color: white; border: 2px solid #4285f4; border-radius: 5px; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; font-weight: bold; cursor: pointer; z-index: 1000;">
                ← Editor
            </button>
            
            
            <!-- Pantalla de carga -->
            <div id="loading-screen" class="overlay">
                <div class="loading-container">
                    <h1 class="loading-title">Supply Line Commander</h1>
                    <div class="loading-spinner"></div>
                    <div class="loading-bar-container">
                        <div class="loading-bar-fill" id="loading-bar-fill"></div>
                    </div>
                    <p class="loading-text" id="loading-text">Cargando recursos...</p>
                    <p class="loading-percentage" id="loading-percentage">0%</p>
                </div>
            </div>

            <!-- Pantalla "Press to Continue" -->
            <div id="press-to-continue-screen" class="overlay hidden">
                <div class="press-to-continue-container">
                    <p class="press-to-continue-text">Pulsa para continuar</p>
                </div>
            </div>

            <div id="main-menu-overlay" class="overlay hidden">
                <div class="main-menu-container">
                    <div class="menu-header">
                        <h1 class="menu-title">Supply Line Commander</h1>
                    </div>
                    
                    <div class="menu-actions">
                        <button id="start-game-btn" class="menu-btn primary">Comenzar Misión</button>
                        <button id="multiplayer-btn" class="menu-btn primary">Multijugador</button>
                        <button id="tutorial-btn" class="menu-btn secondary">Tutorial</button>
                        <button id="arsenal-btn" class="menu-btn secondary">Arsenal</button>
                        <button id="options-btn" class="menu-btn secondary">Opciones</button>
                        <button id="exit-btn" class="menu-btn secondary">Salir</button>
                    </div>
                </div>
            </div>

            <!-- Lobby Multijugador -->
            <div id="multiplayer-lobby-overlay" class="overlay hidden">
                <div class="main-menu-container">
                    <div class="menu-header">
                        <button id="lobby-back-btn" class="back-btn">← Volver</button>
                        <h1 class="menu-title">Multijugador 1v1</h1>
                    </div>
                    
                    <!-- Vista inicial: Crear o unirse -->
                    <div id="lobby-initial-view" class="menu-actions">
                        <div id="lobby-status" style="color: white; margin-bottom: 20px; font-size: 18px;">
                            Conectando al servidor...
                        </div>
                        
                        <button id="create-room-btn" class="menu-btn primary">Crear Sala</button>
                        <button id="join-room-btn" class="menu-btn secondary">Unirse a Sala</button>
                        
                        <div id="room-code-input-container" style="display: none; margin-top: 20px;">
                            <input type="text" id="room-code-input" placeholder="Código de sala (4 letras)" 
                                   maxlength="4" style="padding: 10px; font-size: 18px; text-align: center; text-transform: uppercase; width: 200px;">
                            <button id="join-with-code-btn" class="menu-btn primary" style="margin-top: 10px;">Unirse</button>
                        </div>
                    </div>
                    
                    <!-- Vista dentro de la sala -->
                    <div id="lobby-room-view" style="display: none; padding: 20px; max-width: 900px; margin: 0 auto;">
                        <!-- Código de sala -->
                        <div style="text-align: center; margin-bottom: 30px;">
                            <p style="color: #888; font-size: 14px; margin-bottom: 5px;">CÓDIGO DE SALA</p>
                            <p id="room-code-display" style="font-size: 32px; font-weight: bold; color: #4ecca3; letter-spacing: 8px; text-shadow: 0 0 10px rgba(78, 204, 163, 0.5);"></p>
                        </div>
                        
                        <!-- Lista de jugadores -->
                        <div style="margin-bottom: 30px;">
                            <h3 style="color: #4ecca3; margin-bottom: 15px; font-size: 18px; text-transform: uppercase; letter-spacing: 2px;">JUGADORES</h3>
                            <div id="players-list">
                                <!-- Se llenará dinámicamente -->
                            </div>
                        </div>
                        
                        <!-- Chat -->
                        <div style="margin-bottom: 30px;">
                            <h3 style="color: #4ecca3; margin-bottom: 15px; font-size: 18px; text-transform: uppercase; letter-spacing: 2px;">CHAT</h3>
                            <div id="chat-messages" style="
                                height: 150px;
                                overflow-y: auto;
                                background: rgba(0, 0, 0, 0.7);
                                border: 2px solid #333;
                                border-radius: 5px;
                                padding: 10px;
                                margin-bottom: 10px;
                                font-family: monospace;
                                font-size: 14px;
                            ">
                                <!-- Mensajes se añaden aquí -->
                            </div>
                            <div style="display: flex; gap: 10px;">
                                <input type="text" id="chat-input" placeholder="Escribe un mensaje..." style="
                                    flex: 1;
                                    padding: 10px;
                                    background: rgba(0, 0, 0, 0.7);
                                    border: 2px solid #333;
                                    border-radius: 5px;
                                    color: white;
                                    font-size: 14px;
                                " maxlength="100">
                                <button id="chat-send-btn" class="menu-btn secondary" style="padding: 10px 20px;">Enviar</button>
                            </div>
                        </div>
                        
                        <!-- Botones de acción -->
                        <div style="display: flex; gap: 15px; justify-content: center; align-items: center;">
                            <button id="ready-toggle-btn" class="menu-btn primary">Marcar Listo</button>
                            <button id="start-multiplayer-game-btn" class="menu-btn primary" style="display: none;">Comenzar Partida</button>
                        </div>
                    </div>
                </div>
            </div>


            <!-- Menú de Arsenal -->
            <div id="arsenal-overlay" class="overlay hidden">
                <div class="arsenal-container">
                    <div class="arsenal-header">
                        <button id="arsenal-back-btn" class="back-btn">← Volver</button>
                        <h2 class="arsenal-title">Arsenal</h2>
                    </div>

                    <div class="arsenal-body">
                        <div class="arsenal-content" id="arsenal-content">
                            <!-- El contenido se generará dinámicamente -->
                        </div>

                        <aside class="arsenal-detail" id="arsenal-detail">
                            <canvas id="detail-canvas" class="detail-canvas" width="307" height="205"></canvas>
                            <div class="detail-info ui-frame">
                                <p class="detail-name">Pasa el ratón por un elemento</p>
                                <p class="detail-cost"></p>
                                <p class="detail-desc"></p>
                            </div>
                        </aside>
                    </div>
                </div>
            </div>

            <!-- Pantalla de Victoria -->
            <div id="victory-overlay" class="overlay hidden">
                <div class="main-menu-container">
                    <div class="menu-header">
                        <h1 class="menu-title" style="color: #4ecca3;">¡VICTORIA!</h1>
                    </div>
                    
                    <div class="menu-actions">
                        <button id="victory-menu-btn" class="menu-btn primary">Volver al Menú</button>
                    </div>
                </div>
            </div>

            <!-- Pantalla de Derrota -->
            <div id="defeat-overlay" class="overlay hidden">
                <div class="main-menu-container">
                    <div class="menu-header">
                        <h1 class="menu-title" style="color: #e74c3c;">DERROTA</h1>
                    </div>
                    
                    <div class="menu-actions">
                        <button id="defeat-menu-btn" class="menu-btn primary">Volver al Menú</button>
                    </div>
                </div>
            </div>

            <!-- Menú de Pausa -->
            <div id="pause-overlay" class="overlay hidden">
                <div class="main-menu-container">
                    <div class="menu-header">
                        <h1 class="menu-title">Pausa</h1>
                    </div>
                    
                    <div class="menu-actions">
                        <button id="pause-continue-btn" class="menu-btn primary">Continuar</button>
                        <button id="pause-restart-btn" class="menu-btn primary">Reiniciar misión</button>
                        <button id="pause-options-btn" class="menu-btn secondary">Opciones</button>
                        <button id="pause-exit-btn" class="menu-btn secondary">Volver al menú</button>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <!-- Menú de opciones -->
    <div id="options-menu" class="options-menu" style="display: none;">
        <div class="options-content">
            <h2>Opciones</h2>
            
            <div class="volume-control">
                <label for="master-volume-slider">Volumen Maestro:</label>
                <div class="slider-container">
                    <input type="range" id="master-volume-slider" min="0" max="100" value="100" class="volume-slider">
                    <span id="master-volume-label" class="volume-label">100%</span>
                </div>
            </div>
            
            <div class="volume-control">
                <label for="music-volume-slider">Volumen Música:</label>
                <div class="slider-container">
                    <input type="range" id="music-volume-slider" min="0" max="100" value="100" class="volume-slider">
                    <span id="music-volume-label" class="volume-label">100%</span>
                </div>
            </div>
            
            <div class="volume-control">
                <label for="sfx-volume-slider">Volumen Efectos:</label>
                <div class="slider-container">
                    <input type="range" id="sfx-volume-slider" min="0" max="100" value="100" class="volume-slider">
                    <span id="sfx-volume-label" class="volume-label">100%</span>
                </div>
            </div>
            
            <div class="options-buttons">
                <button id="reset-options-btn" class="action-btn">Restaurar por defecto</button>
                <button id="close-options-btn" class="action-btn">Cerrar</button>
            </div>
        </div>
    </div>

    <script type="module" src="src/main.js"></script>
</body>
</html>

            <div id="upgrades-overlay" class="overlay hidden">
                <div class="upgrades-container">
                    <div class="upgrades-header">
                        <button id="close-upgrades-btn" class="back-btn">← Volver</button>
                        <div class="upgrades-currency">
                            <span id="medals-count-upgrades">0</span>
                            <span class="currency-icon">Medallas</span>
                        </div>
                    </div>
                    
                    <h2 class="upgrades-title">Mejoras Permanentes</h2>
                    
                    <div id="permanent-upgrades">
                        <!-- Construcción -->
                        <div class="upgrade-tree-category">
                            <h3 class="upgrade-category-title">Construcción y Expansión</h3>
                            <div class="upgrade-tree-row">
                                <div class="upgrade-item" data-upgrade="build">
                                    <div class="upgrade-content">
                                        <h3 class="upgrade-name">Sistema de Construcción</h3>
                                        <p class="upgrade-description">Construye 1 FOB por nivel durante las misiones</p>
                                    </div>
                                    <div class="upgrade-action"></div>
                                </div>
                                <div class="upgrade-item" data-upgrade="quick-build">
                                    <div class="upgrade-content">
                                        <h3 class="upgrade-name">Construcción Rápida</h3>
                                        <p class="upgrade-description">Los FOBs construidos obtienen +30 recursos adicionales</p>
                                    </div>
                                    <div class="upgrade-action"></div>
                                </div>
                                <div class="upgrade-item" data-upgrade="fortified-fobs">
                                    <div class="upgrade-content">
                                        <h3 class="upgrade-name">FOBs Fortificados</h3>
                                        <p class="upgrade-description">Los FOBs construidos tienen +30 capacidad máxima</p>
                                    </div>
                                    <div class="upgrade-action"></div>
                                </div>
                                <div class="upgrade-item" data-upgrade="double-build">
                                    <div class="upgrade-content">
                                        <h3 class="upgrade-name">Constructor Experto</h3>
                                        <p class="upgrade-description">Construye hasta 2 FOBs por nivel</p>
                                    </div>
                                    <div class="upgrade-action"></div>
                                </div>
                            </div>
                        </div>

                        <!-- Vehículos -->
                        <div class="upgrade-tree-category">
                            <h3 class="upgrade-category-title">Vehículos y Capacidad</h3>
                            <div class="upgrade-tree-row">
                                <div class="upgrade-item" data-upgrade="fob-vehicles">
                                    <div class="upgrade-content">
                                        <h3 class="upgrade-name">Vehículos FOB Mejorados</h3>
                                        <p class="upgrade-description">Los FOBs tienen +1 vehículo (3 total)</p>
                                    </div>
                                    <div class="upgrade-action"></div>
                                </div>
                                <div class="upgrade-item" data-upgrade="hq-vehicles">
                                    <div class="upgrade-content">
                                        <h3 class="upgrade-name">Flota HQ Ampliada</h3>
                                        <p class="upgrade-description">El HQ tiene +2 vehículos (8 total)</p>
                                    </div>
                                    <div class="upgrade-action"></div>
                                </div>
                                <div class="upgrade-item" data-upgrade="larger-convoys">
                                    <div class="upgrade-content">
                                        <h3 class="upgrade-name">Convoyes Pesados</h3>
                                        <p class="upgrade-description">+50% capacidad de carga en todos los vehículos</p>
                                    </div>
                                    <div class="upgrade-action"></div>
                                </div>
                                <div class="upgrade-item" data-upgrade="mega-fleet">
                                    <div class="upgrade-content">
                                        <h3 class="upgrade-name">Mega Flota</h3>
                                        <p class="upgrade-description">HQ +3 vehículos, FOB +2 vehículos adicionales</p>
                                    </div>
                                    <div class="upgrade-action"></div>
                                </div>
                            </div>
                        </div>

                        <!-- Velocidad -->
                        <div class="upgrade-tree-category">
                            <h3 class="upgrade-category-title">Velocidad y Eficiencia</h3>
                            <div class="upgrade-tree-row">
                                <div class="upgrade-item" data-upgrade="multi-dispatch">
                                    <div class="upgrade-content">
                                        <h3 class="upgrade-name">Doble Despacho</h3>
                                        <p class="upgrade-description">HQ y FOBs pueden enviar 2 vehículos al mismo tiempo</p>
                                    </div>
                                    <div class="upgrade-action"></div>
                                </div>
                                <div class="upgrade-item" data-upgrade="faster-convoys">
                                    <div class="upgrade-content">
                                        <h3 class="upgrade-name">Motores Mejorados</h3>
                                        <p class="upgrade-description">Todos los vehículos se mueven +30% más rápido</p>
                                    </div>
                                    <div class="upgrade-action"></div>
                                </div>
                                <div class="upgrade-item" data-upgrade="return-speed">
                                    <div class="upgrade-content">
                                        <h3 class="upgrade-name">Retorno Rápido</h3>
                                        <p class="upgrade-description">Los vehículos vuelven +100% más rápido</p>
                                    </div>
                                    <div class="upgrade-action"></div>
                                </div>
                                <div class="upgrade-item" data-upgrade="efficient-routes">
                                    <div class="upgrade-content">
                                        <h3 class="upgrade-name">Rutas Eficientes</h3>
                                        <p class="upgrade-description">Los vehículos regresan instantáneamente a su base</p>
                                    </div>
                                    <div class="upgrade-action"></div>
                                </div>
                                <div class="upgrade-item" data-upgrade="turbo-mode">
                                    <div class="upgrade-content">
                                        <h3 class="upgrade-name">Modo Turbo</h3>
                                        <p class="upgrade-description">Velocidad de vehículos +50% adicional (total +80%)</p>
                                    </div>
                                    <div class="upgrade-action"></div>
                                </div>
                            </div>
                        </div>

                        <!-- Recursos -->
                        <div class="upgrade-tree-category">
                            <h3 class="upgrade-category-title">Recursos y Economía</h3>
                            <div class="upgrade-tree-row">
                                <div class="upgrade-item" data-upgrade="front-buffer">
                                    <div class="upgrade-content">
                                        <h3 class="upgrade-name">Búnkers Reforzados</h3>
                                        <p class="upgrade-description">Los frentes tienen +30% capacidad máxima</p>
                                    </div>
                                    <div class="upgrade-action"></div>
                                </div>
                                <div class="upgrade-item" data-upgrade="fast-transfer">
                                    <div class="upgrade-content">
                                        <h3 class="upgrade-name">Transferencia Prioritaria</h3>
                                        <p class="upgrade-description">FOBs pueden almacenar +50 recursos (130 total)</p>
                                    </div>
                                    <div class="upgrade-action"></div>
                                </div>
                                <div class="upgrade-item" data-upgrade="larger-storage">
                                    <div class="upgrade-content">
                                        <h3 class="upgrade-name">Almacenes Ampliados</h3>
                                        <p class="upgrade-description">Todas las bases tienen +30% capacidad máxima</p>
                                    </div>
                                    <div class="upgrade-action"></div>
                                </div>
                                <div class="upgrade-item" data-upgrade="starting-supplies">
                                    <div class="upgrade-content">
                                        <h3 class="upgrade-name">Suministros Iniciales</h3>
                                        <p class="upgrade-description">Los frentes empiezan con recursos al máximo</p>
                                    </div>
                                    <div class="upgrade-action"></div>
                                </div>
                                <div class="upgrade-item" data-upgrade="slow-consumption">
                                    <div class="upgrade-content">
                                        <h3 class="upgrade-name">Racionamiento Eficiente</h3>
                                        <p class="upgrade-description">Los frentes consumen -20% de recursos</p>
                                    </div>
                                    <div class="upgrade-action"></div>
                                </div>
                            </div>
                        </div>

                        <!-- Pasivas -->
                        <div class="upgrade-tree-category">
                            <h3 class="upgrade-category-title">Habilidades Pasivas</h3>
                            <div class="upgrade-tree-row">
                                <div class="upgrade-item" data-upgrade="emergency-heli">
                                    <div class="upgrade-content">
                                        <h3 class="upgrade-name">Helicóptero de Emergencia</h3>
                                        <p class="upgrade-description">Cada 15s, el HQ envía 20 recursos a cada FOB automáticamente</p>
                                    </div>
                                    <div class="upgrade-action"></div>
                                </div>
                                <div class="upgrade-item" data-upgrade="auto-supply">
                                    <div class="upgrade-content">
                                        <h3 class="upgrade-name">Logística Automática</h3>
                                        <p class="upgrade-description">FOBs envían automáticamente suministros a frentes críticos</p>
                                    </div>
                                    <div class="upgrade-action"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <script type="module" src="src/main.js"></script>
</body>
</html>
