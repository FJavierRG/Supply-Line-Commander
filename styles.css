/* ===== VARIABLES CSS GLOBALES ===== */
:root {
    /* Z-Index Scale - Sistema de capas consistente */
    --z-canvas: 1;           /* Canvas del juego (fondo) */
    --z-game-hud: 5;         /* HUD durante el juego (timer, currency) */
    --z-screens: 10;         /* Pantallas principales (menÃº, arsenal, lobby) */
    --z-modals: 100;         /* Modales y overlays temporales */
    --z-notifications: 1000; /* Notificaciones y tooltips */
    
    /* Colores principales */
    --color-primary: #4ecca3;
    --color-bg-dark: #1a1a2e;
    --color-bg-darker: #16213e;
    --color-text: #eee;
    --color-danger: #e74c3c;
    
    /* Transiciones */
    --transition-speed: 0.3s;
    --border-radius: 8px;
}

.tooltip {
    position: relative;
    cursor: help;
    text-decoration: underline dotted rgba(255,255,255,0.4);
    color: #4ecca3; /* color acento */
    font-style: italic; /* cursiva para indicar interacciÃ³n */
}

.tooltip[data-tip]:hover::after {
    content: attr(data-tip);
    position: absolute;
    left: 50%;
    bottom: 125%;
    transform: translateX(-50%);
    background: rgba(0,0,0,0.9);
    color: #fff;
    padding: 6px 8px;
    font-size: 12px;
    white-space: nowrap;
    border: 1px solid rgba(78, 204, 163, 0.3);
    pointer-events: none;
    z-index: var(--z-notifications);
}

.tooltip[data-tip]:hover::before {
    content: '';
    position: absolute;
    left: 50%;
    bottom: 115%;
    transform: translateX(-50%);
    border-width: 6px;
    border-style: solid;
    border-color: rgba(0,0,0,0.9) transparent transparent transparent;
}
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

html, body {
    /* Prevenir zoom del navegador */
    touch-action: manipulation;
    -ms-touch-action: manipulation;
}

body {
    font-family: 'Courier New', monospace;
    background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
    color: #eee;
    overflow: hidden;
    /* Prevenir zoom en mÃ³viles y desktop */
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
}

#game-container {
    height: 100vh;
    width: 100vw;
}

/* Ocultar todo el juego cuando el menÃº estÃ¡ abierto */
/* Ocultar elementos del juego cuando el menÃº estÃ¡ abierto */
body.menu-open #timer-display,
body.menu-open #fob-currency-display,
body.menu-open #camera-slider-container,
body.menu-open #surrender-btn,
body.menu-open #dev-skip-btn,
body.menu-open #dev-supply-enemy-btn,
body.menu-open #back-to-editor-btn,
body.menu-open #start-timer-btn {
    display: none;
}

/* Ocultar elementos del HUD por defecto - se mostrarÃ¡n cuando el juego lo requiera */
#timer-display,
#fob-currency-display {
    display: none;
}

/* Ocultar elementos del HUD durante la pantalla de carga */
#loading-screen:not(.hidden) ~ *,
body:has(#loading-screen:not(.hidden)) #timer-display,
body:has(#loading-screen:not(.hidden)) #fob-currency-display,
body:has(#loading-screen:not(.hidden)) #start-timer-btn {
    display: none;
    visibility: hidden;
    opacity: 0;
    pointer-events: none;
}

body.menu-open #game-canvas {
    opacity: 0; /* evita ver el Ãºltimo frame detrÃ¡s del overlay */
    visibility: hidden; /* ðŸ†• FIX: Ocultar completamente el canvas en menÃº */
    pointer-events: none; /* ðŸ†• FIX: Deshabilitar interacciones */
}

#main-game {
    width: 100%;
    height: 100%;
    position: relative;
    overflow: hidden;
}

#game-canvas {
    /* TamaÃ±o controlado por JavaScript para escalado correcto */
    display: block;
    cursor: crosshair;
    position: absolute;
    top: 0;
    left: 0;
    z-index: var(--z-canvas);
    pointer-events: auto; /* Activo por defecto */
}

/* Slider de cÃ¡mara - DESACTIVADO (mundo 1:1 con viewport) */
#camera-slider-container {
    display: none;
}

#camera-slider {
    width: 100%;
    height: 8px;
    background: rgba(0, 0, 0, 0.5);
    border-radius: 5px;
    outline: none;
    opacity: 0.7;
    transition: opacity 0.2s;
    cursor: pointer;
}

#camera-slider:hover {
    opacity: 1;
}

#camera-slider::-webkit-slider-thumb {
    appearance: none;
    width: 20px;
    height: 20px;
    background: #4ecca3;
    border-radius: 50%;
    cursor: pointer;
    box-shadow: 0 0 10px rgba(78, 204, 163, 0.8);
}

#camera-slider::-moz-range-thumb {
    width: 20px;
    height: 20px;
    background: #4ecca3;
    border-radius: 50%;
    cursor: pointer;
    border: none;
    box-shadow: 0 0 10px rgba(78, 204, 163, 0.8);
}

#timer-display {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    z-index: var(--z-game-hud);
    display: flex;
    flex-direction: row;
    align-items: center;
    gap: 20px;
}

#timer-display #timer {
    font-family: 'Courier New', monospace;
    font-size: 56px;
    font-weight: bold;
    color: #4ecca3;
    text-shadow: 0 0 15px rgba(78, 204, 163, 0.8),
                 0 0 30px rgba(78, 204, 163, 0.5),
                 2px 2px 4px rgba(0, 0, 0, 0.8);
    background: rgba(10, 14, 39, 0.7);
    padding: 10px 30px;
    border-radius: 10px;
    border: 2px solid rgba(78, 204, 163, 0.3);
    pointer-events: none;
}

#pause-btn {
    display: none; /* Oculto por defecto, se muestra durante el juego */
}


#surrender-btn {
    position: absolute;
    left: 20px;
    top: 110px;
    font-size: 50px;
    width: 80px;
    height: 80px;
    background: rgba(231, 76, 60, 0.8);
    border: 3px solid rgba(231, 76, 60, 1);
    border-radius: 15px;
    cursor: pointer;
    transition: all 0.3s ease;
    z-index: var(--z-modals);
    box-shadow: 0 5px 20px rgba(231, 76, 60, 0.4);
    display: none;
}

#surrender-btn:hover {
    background: rgba(231, 76, 60, 1);
    transform: scale(1.1);
    box-shadow: 0 8px 30px rgba(231, 76, 60, 0.6);
}

#loop-indicator {
    position: absolute;
    top: 24px;
    right: 24px;
    z-index: var(--z-game-hud);
    background: rgba(10, 14, 39, 0.9);
    padding: 8px 16px;
    border-radius: 8px;
    border: 1px solid rgba(255, 255, 255, 0.1);
}

#loop-count {
    font-family: 'Courier New', monospace;
    font-size: 14px;
    font-weight: 600;
    color: #a0a0a0;
    letter-spacing: 0.3px;
}

/* Indicador de currency FOB */
#fob-currency-display {
    position: absolute;
    top: 35px; /* Bajado 5 pÃ­xeles */
    left: 320px; /* MÃ¡s separado del botÃ³n de tienda para que no se tape */
    z-index: var(--z-game-hud);
    width: 210px; /* Mitad del ancho original (420/2) */
    height: 83px; /* Altura original (166/2) */
    background-image: url('assets/sprites/ui/UIFrames/currency_bton.png');
    background-size: contain;
    background-repeat: no-repeat;
    background-position: center;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 4px;
    padding: 12px 0 0 0; /* Espacio por debajo para centrar mejor */
    white-space: nowrap;
}

#fob-currency-icon {
    width: 24px;
    height: 24px;
    filter: drop-shadow(0 0 8px rgba(52, 152, 219, 0.6));
    image-rendering: pixelated;
    image-rendering: -moz-crisp-edges;
    image-rendering: crisp-edges;
}

.cost-icon {
    width: 20px;
    height: 20px;
    image-rendering: pixelated;
    image-rendering: -moz-crisp-edges;
    image-rendering: crisp-edges;
    vertical-align: middle;
    margin-right: 4px;
}

#fob-currency-amount {
    font-family: 'Courier New', monospace;
    font-size: 18px;
    font-weight: bold;
    color: #000000;
    line-height: 1;
}

#fob-currency-label {
    font-family: 'Courier New', monospace;
    font-size: 12px;
    color: #000000;
    font-weight: 500;
    line-height: 1;
}

/* MenÃº principal rediseÃ±ado */
/* Fondo del menÃº principal con imagen */
#main-menu-overlay {
    background-image: url('assets/sprites/ui/main_menu_backgrouind.png');
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
}

#main-menu-overlay::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.5);
    z-index: 0;
    pointer-events: none;
}

.main-menu-container {
    max-width: 500px;
    width: 90%;
    margin: 0 auto;
    padding: 60px 40px;
    position: relative;
    z-index: 1; /* Asegurar que el contenido estÃ© encima del overlay oscuro */
}

.menu-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 80px;
    border-bottom: 1px solid rgba(78, 204, 163, 0.2);
    padding-bottom: 20px;
}

.menu-title {
    font-size: 24px;
    font-weight: 600;
    color: #4ecca3;
    margin: 0;
    letter-spacing: 0.5px;
    text-transform: none;
    text-shadow: none;
}

#medals-display-mini {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 8px 16px;
    background: rgba(243, 156, 18, 0.15);
    border-radius: 20px;
    border: 1px solid rgba(243, 156, 18, 0.3);
}

#medals-display-mini .medal-icon {
    font-size: 18px;
}

#medals-display-mini #medals-count {
    font-size: 20px;
    font-weight: bold;
    color: #f39c12;
    min-width: 20px;
    text-align: right;
}

.menu-actions {
    display: flex;
    flex-direction: column;
    gap: 16px;
    /* Fondo con la imagen del frame */
    background-image: url('assets/sprites/ui/UIFrames/main_menu_options.png');
    background-size: contain;
    background-position: center;
    background-repeat: no-repeat;
    /* Ajustar padding para que el contenido quede dentro del frame - estrechado 10px */
    padding: 40px 50px;
    /* Asegurar que el contenedor tenga el tamaÃ±o adecuado */
    min-height: 500px;
    position: relative;
    /* Estrechar el ancho del frame */
    max-width: calc(100% - 10px);
    width: calc(100% - 10px);
}

.menu-btn {
    width: 100%; /* Ocupar todo el ancho disponible dentro del frame */
    margin: 0 auto; /* Centrar horizontalmente */
    padding: 24px;
    font-size: 20px; /* Aumentado de 18px a 20px (+2 puntos) */
    font-weight: 600;
    font-family: 'Courier New', monospace;
    border: none;
    border-radius: 0;
    cursor: pointer;
    transition: all 0.2s ease;
    letter-spacing: 0.3px;
    /* Sin fondo - solo texto sobre la imagen del frame */
    background: none;
    background-image: none;
    /* Asegurar que el botÃ³n sea clickeable en toda su Ã¡rea */
    position: relative;
    z-index: 1;
}

.menu-btn.primary {
    color: #ccc; /* Cambiado de #fff a #ccc para que no parezca siempre resaltado */
    font-size: 22px; /* Aumentado de 20px a 22px (+2 puntos) */
    padding: 28px;
    text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
    filter: brightness(0.8); /* Mismo filtro que los secundarios */
}

.menu-btn.primary:hover {
    filter: brightness(1.1); /* Mismo que los secundarios */
    color: #fff; /* Solo blanco en hover */
    transform: translateY(-2px);
}

.menu-btn.secondary {
    color: #ccc;
    filter: brightness(0.8);
}

.menu-btn.secondary:hover {
    filter: brightness(1.1);
    color: #fff;
}

/* Sprite de "shoot" a la izquierda de la opciÃ³n resaltada */
.menu-btn:hover::before {
    content: '';
    position: absolute;
    left: -10px; /* Pegado al texto */
    top: 50%;
    transform: translateY(-50%);
    width: 24px;
    height: 24px;
    background-image: url('assets/sprites/ui/UIFrames/shoot.png');
    background-size: contain;
    background-repeat: no-repeat;
    background-position: center;
    z-index: 2;
    pointer-events: none;
}

/* Asegurar que el botÃ³n primario no tenga el sprite por defecto, solo en hover */
.menu-btn.primary::before {
    display: none;
}

.menu-btn.primary:hover::before {
    display: block;
}

/* ===== PANTALLA DE MEJORAS - SISTEMA DE DISEÃ‘O ===== */

.upgrades-container {
    max-width: 700px;
    width: 90%;
    max-height: 85vh;
    margin: 0 auto;
    padding: 32px;
    overflow-y: auto;
    overflow-x: hidden;
}

/* Estilo del scrollbar para la pantalla de mejoras */
.upgrades-container::-webkit-scrollbar {
    width: 8px;
}

.upgrades-container::-webkit-scrollbar-track {
    background: rgba(255, 255, 255, 0.05);
    border-radius: 4px;
}

.upgrades-container::-webkit-scrollbar-thumb {
    background: rgba(78, 204, 163, 0.5);
    border-radius: 4px;
}

.upgrades-container::-webkit-scrollbar-thumb:hover {
    background: rgba(78, 204, 163, 0.7);
}

/* Header con navegaciÃ³n y currency */
.upgrades-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 32px;
}

.back-btn {
    background: none;
    border: none;
    color: #a0a0a0;
    font-size: 16px;
    font-family: 'Courier New', monospace;
    cursor: pointer;
    padding: 8px 0;
    transition: color 0.2s ease;
}

/* Botones del arsenal en negrita */
#arsenal-new-btn,
#arsenal-load-btn {
    font-weight: bold;
}

.back-btn:hover {
    color: #fff;
}

/* Currency indicator - contextual, no protagonista */
.upgrades-currency {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 8px 16px;
    background: rgba(243, 156, 18, 0.1);
    border-radius: 16px;
    border: 1px solid rgba(243, 156, 18, 0.25);
}

#medals-count-upgrades {
    font-size: 18px;
    font-weight: 600;
    color: #f39c12;
    min-width: 24px;
    text-align: right;
}

.currency-icon {
    font-size: 16px;
    opacity: 0.8;
}

/* TÃ­tulo de secciÃ³n */
.upgrades-title {
    font-size: 20px;
    font-weight: 600;
    color: #e0e0e0;
    margin: 0 0 24px 0;
    letter-spacing: 0.3px;
}

/* Lista de mejoras por categorÃ­as */
#permanent-upgrades {
    display: flex;
    flex-direction: column;
    gap: 24px;
}

.upgrade-tree-category {
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.upgrade-category-title {
    font-size: 14px;
    font-weight: 700;
    color: #4ecca3;
    margin: 0 0 12px 0;
    padding: 8px 0;
    letter-spacing: 0.5px;
    text-transform: uppercase;
    border-bottom: 2px solid rgba(78, 204, 163, 0.3);
}

.upgrade-tree-row {
    display: flex;
    flex-direction: column;
    gap: 8px;
}

/* Upgrade item simple */
.upgrade-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 16px;
    padding: 16px;
    background: rgba(255, 255, 255, 0.03);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 8px;
    transition: all 0.2s ease;
}

.upgrade-item:hover {
    background: rgba(255, 255, 255, 0.05);
    border-color: rgba(78, 204, 163, 0.3);
}

.upgrade-item.unlocked {
    background: rgba(78, 204, 163, 0.08);
    border-color: rgba(78, 204, 163, 0.4);
}

/* Contenido del upgrade */
.upgrade-content {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 4px;
}

.upgrade-name {
    font-size: 15px;
    font-weight: 600;
    color: #ffffff;
    margin: 0;
    line-height: 1.4;
}

.upgrade-description {
    font-size: 13px;
    color: #a0a0a0;
    margin: 0;
    line-height: 1.5;
}

/* AcciÃ³n del upgrade */
.upgrade-action {
    flex-shrink: 0;
}

/* BotÃ³n de compra */
.upgrade-purchase-btn {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 4px;
    padding: 12px 20px;
    background: linear-gradient(135deg, #4ecca3, #3dbb8f);
    border: none;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.2s ease;
    min-width: 100px;
}

.upgrade-purchase-btn:hover:not(:disabled) {
    background: linear-gradient(135deg, #5efcb3, #4ecca3);
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(78, 204, 163, 0.3);
}

.upgrade-purchase-btn:disabled {
    background: rgba(255, 255, 255, 0.05);
    cursor: not-allowed;
    opacity: 0.5;
}

.btn-cost {
    font-size: 16px;
    font-weight: 700;
    color: #0a0e27;
}

.upgrade-purchase-btn:disabled .btn-cost {
    color: #666;
}

.btn-label {
    font-size: 12px;
    font-weight: 600;
    color: #0a0e27;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.upgrade-purchase-btn:disabled .btn-label {
    color: #666;
}

/* Badge de estado */
.upgrade-badge {
    display: inline-block;
    padding: 8px 16px;
    border-radius: 8px;
    font-size: 12px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.upgrade-badge.unlocked {
    background: rgba(78, 204, 163, 0.15);
    color: #4ecca3;
    border: 1px solid rgba(78, 204, 163, 0.3);
}

/* ===== BOTÃ“N DE INICIO EN JUEGO ===== */

.game-start-overlay-btn {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    padding: 20px 48px;
    background: linear-gradient(135deg, #4ecca3, #3dbb8f);
    color: #0a0e27;
    border: none;
    border-radius: 12px;
    font-family: 'Courier New', monospace;
    font-weight: 600;
    font-size: 20px;
    cursor: pointer;
    z-index: var(--z-modals);
    box-shadow: 0 8px 32px rgba(78, 204, 163, 0.4);
    display: none;
    transition: all 0.3s ease;
    letter-spacing: 0.5px;
}

.game-start-overlay-btn:hover {
    background: linear-gradient(135deg, #5efcb3, #4ecca3);
    transform: translate(-50%, -50%) scale(1.05);
    box-shadow: 0 12px 40px rgba(78, 204, 163, 0.6);
}

/* ===== NUEVA ESTRUCTURA: Capa de UI separada ===== */

/* Capa de UI siempre arriba del canvas */
#ui-layer {
    position: absolute;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    z-index: var(--z-modals); /* Siempre arriba del canvas */
    pointer-events: none; /* Permite clicks a travÃ©s cuando no hay overlay visible */
}

/* Overlays dentro de ui-layer capturan eventos cuando estÃ¡n visibles */
#ui-layer .overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background: rgba(0, 0, 0, 0.85);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: var(--z-screens);
    backdrop-filter: blur(5px);
    pointer-events: auto; /* Permitir interacciÃ³n cuando estÃ¡ visible */
}

/* ExcepciÃ³n: MenÃº principal con imagen de fondo */
#ui-layer #main-menu-overlay.overlay {
    background-color: transparent;
    background-image: url('assets/sprites/ui/main_menu_backgrouind.png');
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    backdrop-filter: none;
    overflow: hidden; /* Para que la lluvia no se salga */
}

/* ExcepciÃ³n: Lobby multijugador y Arsenal con imagen de fondo de submenÃº */
#ui-layer #multiplayer-lobby-overlay.overlay,
#ui-layer #arsenal-overlay.overlay {
    background-color: transparent;
    background-image: url('assets/sprites/ui/submenu_background.png');
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    backdrop-filter: none;
}

/* Overlay oscuro para legibilidad en submenÃºs */
#multiplayer-lobby-overlay::before,
#arsenal-overlay::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.5);
    z-index: 0;
    pointer-events: none;
}

/* Asegurar que el contenido estÃ© encima del overlay oscuro */
#multiplayer-lobby-overlay .main-menu-container,
#arsenal-overlay .arsenal-container {
    position: relative;
    z-index: 1;
}

/* Overlays ocultos no capturan eventos */
#ui-layer .overlay.hidden {
    display: none;
    pointer-events: none;
}

/* Bloquear canvas cuando hay cualquier overlay visible en ui-layer */
/* Usar selector mÃ¡s especÃ­fico que funcione en todos los navegadores */
#ui-layer .overlay:not(.hidden) ~ *,
body:has(#ui-layer .overlay:not(.hidden)) #game-canvas {
    pointer-events: none;
}

/* Fallback mÃ¡s robusto: bloquear canvas directamente cuando hay overlay visible */
#main-game:has(#ui-layer .overlay:not(.hidden)) #game-canvas {
    pointer-events: none;
}

/* Fallback: Overlays legacy fuera de ui-layer (compatibilidad) */
.overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background: rgba(0, 0, 0, 0.85);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: var(--z-screens);
    backdrop-filter: blur(5px);
    pointer-events: auto;
}


.overlay.hidden {
    display: none;
    pointer-events: none;
}

/* ===== EFECTO DE LLUVIA PIXEL ART ===== */
.rain-container {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none; /* No interfiere con los clics */
    z-index: 0; /* DetrÃ¡s del contenido del menÃº */
    overflow: hidden;
}

.rain-drop {
    position: absolute;
    width: 2px; /* MÃ¡s anchas */
    height: 17px; /* MÃ¡s largas (+1px) */
    background: rgba(180, 200, 255, 1.0); /* Opacidad completa */
    /* Efecto pixel art - bordes nÃ­tidos */
    image-rendering: pixelated;
    image-rendering: -moz-crisp-edges;
    image-rendering: crisp-edges;
    /* Sombra sutil para profundidad */
    box-shadow: 0 0 3px rgba(180, 200, 255, 0.8);
    /* OptimizaciÃ³n de rendimiento */
    will-change: transform;
    /* AceleraciÃ³n por hardware */
    backface-visibility: hidden;
    /* Rotar -55 grados (menos inclinado) para que apunte hacia abajo-derecha */
    transform: rotate(-55deg);
    transform-origin: center center;
}

/* AnimaciÃ³n de lluvia a 55 grados (desde vertical) - menos inclinado */
/* 55 grados desde vertical = tan(55Â°) â‰ˆ 1.43 unidades horizontales por 1 vertical */
@keyframes rain-fall {
    0% {
        /* PosiciÃ³n inicial: arriba-izquierda fuera de pantalla */
        transform: translateX(calc(-150px * 1.43)) translateY(-150px) rotate(-55deg);
        opacity: 0;
    }
    5% {
        opacity: 1.0;
    }
    95% {
        opacity: 1.0;
    }
    100% {
        /* Movimiento diagonal hacia abajo-derecha */
        /* Por cada unidad vertical, 1.43 unidades horizontales (menos inclinado) */
        transform: translateX(calc((100vh + 150px) * 1.43)) translateY(calc(100vh + 150px)) rotate(-55deg);
        opacity: 0;
    }
}

/* Aplicar animaciÃ³n a cada gota con delays aleatorios y distribuciÃ³n por toda la pantalla */
/* DistribuciÃ³n horizontal MUY amplia: desde -20% hasta 120% para cubrir toda la pantalla */
.rain-drop:not(.rain-from-left):not(.rain-from-right):nth-child(1) {
    left: -20%;
    top: -10%;
    animation: rain-fall 2s linear infinite;
    animation-delay: 0s;
}

.rain-drop:not(.rain-from-left):not(.rain-from-right):nth-child(2) {
    left: -15%;
    top: -20%;
    animation: rain-fall 2.2s linear infinite;
    animation-delay: 0.1s;
}

.rain-drop:not(.rain-from-left):not(.rain-from-right):nth-child(3) {
    left: -10%;
    top: -5%;
    animation: rain-fall 1.8s linear infinite;
    animation-delay: 0.2s;
}

.rain-drop:not(.rain-from-left):not(.rain-from-right):nth-child(4) {
    left: -5%;
    top: -25%;
    animation: rain-fall 2.3s linear infinite;
    animation-delay: 0.3s;
}

.rain-drop:not(.rain-from-left):not(.rain-from-right):nth-child(5) {
    left: 0%;
    top: -15%;
    animation: rain-fall 2.1s linear infinite;
    animation-delay: 0.4s;
}

.rain-drop:not(.rain-from-left):not(.rain-from-right):nth-child(6) {
    left: 5%;
    top: -8%;
    animation: rain-fall 1.9s linear infinite;
    animation-delay: 0.5s;
}

.rain-drop:not(.rain-from-left):not(.rain-from-right):nth-child(7) {
    left: 10%;
    top: -30%;
    animation: rain-fall 2.4s linear infinite;
    animation-delay: 0.6s;
}

.rain-drop:not(.rain-from-left):not(.rain-from-right):nth-child(8) {
    left: 15%;
    top: -12%;
    animation: rain-fall 2s linear infinite;
    animation-delay: 0.7s;
}

.rain-drop:not(.rain-from-left):not(.rain-from-right):nth-child(9) {
    left: 20%;
    top: -18%;
    animation: rain-fall 2.2s linear infinite;
    animation-delay: 0.8s;
}

.rain-drop:not(.rain-from-left):not(.rain-from-right):nth-child(10) {
    left: 25%;
    top: -5%;
    animation: rain-fall 1.8s linear infinite;
    animation-delay: 0.9s;
}

.rain-drop:not(.rain-from-left):not(.rain-from-right):nth-child(11) {
    left: 30%;
    top: -22%;
    animation: rain-fall 2.3s linear infinite;
    animation-delay: 1s;
}

.rain-drop:not(.rain-from-left):not(.rain-from-right):nth-child(12) {
    left: 35%;
    top: -10%;
    animation: rain-fall 2.1s linear infinite;
    animation-delay: 1.1s;
}

.rain-drop:not(.rain-from-left):not(.rain-from-right):nth-child(13) {
    left: 40%;
    top: -28%;
    animation: rain-fall 1.9s linear infinite;
    animation-delay: 1.2s;
}

.rain-drop:not(.rain-from-left):not(.rain-from-right):nth-child(14) {
    left: 45%;
    top: -15%;
    animation: rain-fall 2.4s linear infinite;
    animation-delay: 1.3s;
}

.rain-drop:not(.rain-from-left):not(.rain-from-right):nth-child(15) {
    left: 50%;
    top: -35%;
    animation: rain-fall 2s linear infinite;
    animation-delay: 1.4s;
}

.rain-drop:not(.rain-from-left):not(.rain-from-right):nth-child(16) {
    left: 55%;
    top: -20%;
    animation: rain-fall 2.2s linear infinite;
    animation-delay: 1.5s;
}

.rain-drop:not(.rain-from-left):not(.rain-from-right):nth-child(17) {
    left: 60%;
    top: -32%;
    animation: rain-fall 1.8s linear infinite;
    animation-delay: 1.6s;
}

.rain-drop:not(.rain-from-left):not(.rain-from-right):nth-child(18) {
    left: 65%;
    top: -18%;
    animation: rain-fall 2.3s linear infinite;
    animation-delay: 1.7s;
}

.rain-drop:not(.rain-from-left):not(.rain-from-right):nth-child(19) {
    left: 70%;
    top: -38%;
    animation: rain-fall 2.1s linear infinite;
    animation-delay: 1.8s;
}

.rain-drop:not(.rain-from-left):not(.rain-from-right):nth-child(20) {
    left: 75%;
    top: -25%;
    animation: rain-fall 1.9s linear infinite;
    animation-delay: 1.9s;
}

.rain-drop:not(.rain-from-left):not(.rain-from-right):nth-child(21) {
    left: 80%;
    top: -12%;
    animation: rain-fall 2.2s linear infinite;
    animation-delay: 2s;
}

.rain-drop:not(.rain-from-left):not(.rain-from-right):nth-child(22) {
    left: 85%;
    top: -30%;
    animation: rain-fall 2.4s linear infinite;
    animation-delay: 2.1s;
}

.rain-drop:not(.rain-from-left):not(.rain-from-right):nth-child(23) {
    left: 90%;
    top: -8%;
    animation: rain-fall 1.8s linear infinite;
    animation-delay: 2.2s;
}

.rain-drop:not(.rain-from-left):not(.rain-from-right):nth-child(24) {
    left: 95%;
    top: -22%;
    animation: rain-fall 2.1s linear infinite;
    animation-delay: 2.3s;
}

.rain-drop:not(.rain-from-left):not(.rain-from-right):nth-child(25) {
    left: 100%;
    top: -15%;
    animation: rain-fall 2.3s linear infinite;
    animation-delay: 2.4s;
}

.rain-drop:not(.rain-from-left):not(.rain-from-right):nth-child(26) {
    left: 105%;
    top: -28%;
    animation: rain-fall 2s linear infinite;
    animation-delay: 2.5s;
}

.rain-drop:not(.rain-from-left):not(.rain-from-right):nth-child(27) {
    left: 110%;
    top: -10%;
    animation: rain-fall 1.9s linear infinite;
    animation-delay: 2.6s;
}

.rain-drop:not(.rain-from-left):not(.rain-from-right):nth-child(28) {
    left: 115%;
    top: -35%;
    animation: rain-fall 2.2s linear infinite;
    animation-delay: 2.7s;
}

.rain-drop:not(.rain-from-left):not(.rain-from-right):nth-child(29) {
    left: 120%;
    top: -18%;
    animation: rain-fall 2.4s linear infinite;
    animation-delay: 2.8s;
}

.rain-drop:not(.rain-from-left):not(.rain-from-right):nth-child(30) {
    left: -18%;
    top: -12%;
    animation: rain-fall 2.1s linear infinite;
    animation-delay: 2.9s;
}

.rain-drop:not(.rain-from-left):not(.rain-from-right):nth-child(31) {
    left: -12%;
    top: -25%;
    animation: rain-fall 1.9s linear infinite;
    animation-delay: 3s;
}

.rain-drop:not(.rain-from-left):not(.rain-from-right):nth-child(32) {
    left: -8%;
    top: -8%;
    animation: rain-fall 2.3s linear infinite;
    animation-delay: 3.1s;
}

.rain-drop:not(.rain-from-left):not(.rain-from-right):nth-child(33) {
    left: 8%;
    top: -20%;
    animation: rain-fall 2s linear infinite;
    animation-delay: 3.2s;
}

.rain-drop:not(.rain-from-left):not(.rain-from-right):nth-child(34) {
    left: 12%;
    top: -32%;
    animation: rain-fall 2.2s linear infinite;
    animation-delay: 3.3s;
}

.rain-drop:not(.rain-from-left):not(.rain-from-right):nth-child(35) {
    left: 18%;
    top: -6%;
    animation: rain-fall 1.8s linear infinite;
    animation-delay: 3.4s;
}

.rain-drop:not(.rain-from-left):not(.rain-from-right):nth-child(36) {
    left: 22%;
    top: -28%;
    animation: rain-fall 2.4s linear infinite;
    animation-delay: 3.5s;
}

.rain-drop:not(.rain-from-left):not(.rain-from-right):nth-child(37) {
    left: 28%;
    top: -14%;
    animation: rain-fall 2.1s linear infinite;
    animation-delay: 3.6s;
}

.rain-drop:not(.rain-from-left):not(.rain-from-right):nth-child(38) {
    left: 32%;
    top: -36%;
    animation: rain-fall 1.9s linear infinite;
    animation-delay: 3.7s;
}

.rain-drop:not(.rain-from-left):not(.rain-from-right):nth-child(39) {
    left: 38%;
    top: -10%;
    animation: rain-fall 2.3s linear infinite;
    animation-delay: 3.8s;
}

.rain-drop:not(.rain-from-left):not(.rain-from-right):nth-child(40) {
    left: 42%;
    top: -24%;
    animation: rain-fall 2s linear infinite;
    animation-delay: 3.9s;
}

.rain-drop:not(.rain-from-left):not(.rain-from-right):nth-child(41) {
    left: 48%;
    top: -16%;
    animation: rain-fall 2.2s linear infinite;
    animation-delay: 4s;
}

.rain-drop:not(.rain-from-left):not(.rain-from-right):nth-child(42) {
    left: 52%;
    top: -30%;
    animation: rain-fall 1.8s linear infinite;
    animation-delay: 4.1s;
}

.rain-drop:not(.rain-from-left):not(.rain-from-right):nth-child(43) {
    left: 58%;
    top: -12%;
    animation: rain-fall 2.4s linear infinite;
    animation-delay: 4.2s;
}

.rain-drop:not(.rain-from-left):not(.rain-from-right):nth-child(44) {
    left: 62%;
    top: -26%;
    animation: rain-fall 2.1s linear infinite;
    animation-delay: 4.3s;
}

.rain-drop:not(.rain-from-left):not(.rain-from-right):nth-child(45) {
    left: 68%;
    top: -14%;
    animation: rain-fall 1.9s linear infinite;
    animation-delay: 4.4s;
}

.rain-drop:not(.rain-from-left):not(.rain-from-right):nth-child(46) {
    left: 72%;
    top: -34%;
    animation: rain-fall 2.3s linear infinite;
    animation-delay: 4.5s;
}

.rain-drop:not(.rain-from-left):not(.rain-from-right):nth-child(47) {
    left: 78%;
    top: -8%;
    animation: rain-fall 2s linear infinite;
    animation-delay: 4.6s;
}

.rain-drop:not(.rain-from-left):not(.rain-from-right):nth-child(48) {
    left: 82%;
    top: -22%;
    animation: rain-fall 2.2s linear infinite;
    animation-delay: 4.7s;
}

.rain-drop:not(.rain-from-left):not(.rain-from-right):nth-child(49) {
    left: 88%;
    top: -30%;
    animation: rain-fall 1.8s linear infinite;
    animation-delay: 4.8s;
}

.rain-drop:not(.rain-from-left):not(.rain-from-right):nth-child(50) {
    left: 92%;
    top: -12%;
    animation: rain-fall 2.4s linear infinite;
    animation-delay: 4.9s;
}

.rain-drop:not(.rain-from-left):not(.rain-from-right):nth-child(51) {
    left: 98%;
    top: -28%;
    animation: rain-fall 2.1s linear infinite;
    animation-delay: 5s;
}

.rain-drop:not(.rain-from-left):not(.rain-from-right):nth-child(52) {
    left: 102%;
    top: -16%;
    animation: rain-fall 1.9s linear infinite;
    animation-delay: 5.1s;
}

.rain-drop:not(.rain-from-left):not(.rain-from-right):nth-child(53) {
    left: 108%;
    top: -36%;
    animation: rain-fall 2.3s linear infinite;
    animation-delay: 5.2s;
}

.rain-drop:not(.rain-from-left):not(.rain-from-right):nth-child(54) {
    left: 112%;
    top: -10%;
    animation: rain-fall 2s linear infinite;
    animation-delay: 5.3s;
}

.rain-drop:not(.rain-from-left):not(.rain-from-right):nth-child(55) {
    left: 118%;
    top: -24%;
    animation: rain-fall 2.2s linear infinite;
    animation-delay: 5.4s;
}

/* Gotas desde la izquierda - entran desde fuera del lado izquierdo */
/* IMPORTANTE: Estas gotas deben ir hacia abajo-derecha, igual que las de arriba */
@keyframes rain-from-left {
    0% {
        /* Empezar desde la izquierda, arriba */
        transform: translateX(calc(-100vw - 100px)) translateY(calc(-50vh)) rotate(-55deg);
        opacity: 0;
    }
    5% {
        opacity: 1.0;
    }
    95% {
        opacity: 1.0;
    }
    100% {
        /* Mover diagonalmente hacia abajo-derecha (misma direcciÃ³n que las de arriba) */
        /* Calcular movimiento: baja 150vh, se mueve 150vh * 1.43 horizontalmente hacia la derecha */
        transform: translateX(calc(100vw + 100px + 150vh * 1.43)) translateY(calc(150vh)) rotate(-55deg);
        opacity: 0;
    }
}

/* Gotas desde la izquierda - deben usar su propia animaciÃ³n */
.rain-container .rain-from-left {
    left: -10%;
    top: 0%;
    animation: rain-from-left 2.5s linear infinite;
}

/* Las gotas desde la izquierda - usar nth-child contando desde el inicio */
/* Ahora son 8 gotas (56-63 en el DOM, despuÃ©s de las 55 desde arriba) */
.rain-container > .rain-from-left:nth-child(56) {
    animation-delay: 0s;
    top: 5%;
}

.rain-container > .rain-from-left:nth-child(57) {
    animation-delay: 0.4s;
    top: 20%;
}

.rain-container > .rain-from-left:nth-child(58) {
    animation-delay: 0.8s;
    top: 35%;
}

.rain-container > .rain-from-left:nth-child(59) {
    animation-delay: 1.2s;
    top: 50%;
}

.rain-container > .rain-from-left:nth-child(60) {
    animation-delay: 1.6s;
    top: 65%;
}

.rain-container > .rain-from-left:nth-child(61) {
    animation-delay: 2s;
    top: 80%;
}

.rain-container > .rain-from-left:nth-child(62) {
    animation-delay: 2.4s;
    top: 15%;
}

.rain-container > .rain-from-left:nth-child(63) {
    animation-delay: 2.8s;
    top: 90%;
}

/* Gotas desde la derecha - entran desde fuera del lado derecho */
/* IMPORTANTE: Estas gotas tambiÃ©n deben ir hacia abajo-derecha (misma direcciÃ³n que todas) */
/* Solo cambia el punto de inicio, pero la direcciÃ³n de caÃ­da es la misma */
@keyframes rain-from-right {
    0% {
        /* Empezar desde la derecha, arriba */
        transform: translateX(calc(100vw + 100px)) translateY(calc(-50vh)) rotate(-55deg);
        opacity: 0;
    }
    5% {
        opacity: 1.0;
    }
    95% {
        opacity: 1.0;
    }
    100% {
        /* Mover diagonalmente hacia abajo-derecha (misma direcciÃ³n que todas las demÃ¡s) */
        /* Calcular movimiento: baja 150vh, se mueve 150vh * 1.43 horizontalmente hacia la derecha */
        transform: translateX(calc(200vw + 200px + 150vh * 1.43)) translateY(calc(150vh)) rotate(-55deg);
        opacity: 0;
    }
}

/* Gotas desde la derecha - deben usar su propia animaciÃ³n */
.rain-container .rain-from-right {
    left: 110%;
    top: 0%;
    animation: rain-from-right 2.5s linear infinite;
}

/* Las gotas desde la derecha - usar nth-child contando desde el inicio */
/* Ahora son 8 gotas (64-71 en el DOM, despuÃ©s de las 55 desde arriba + 8 desde la izquierda) */
.rain-container > .rain-from-right:nth-child(64) {
    animation-delay: 0.2s;
    top: 10%;
}

.rain-container > .rain-from-right:nth-child(65) {
    animation-delay: 0.6s;
    top: 25%;
}

.rain-container > .rain-from-right:nth-child(66) {
    animation-delay: 1s;
    top: 40%;
}

.rain-container > .rain-from-right:nth-child(67) {
    animation-delay: 1.4s;
    top: 55%;
}

.rain-container > .rain-from-right:nth-child(68) {
    animation-delay: 1.8s;
    top: 70%;
}

.rain-container > .rain-from-right:nth-child(69) {
    animation-delay: 2.2s;
    top: 85%;
}

.rain-container > .rain-from-right:nth-child(70) {
    animation-delay: 2.6s;
    top: 20%;
}

.rain-container > .rain-from-right:nth-child(71) {
    animation-delay: 3s;
    top: 95%;
}

/* ===== MISSION BRIEFING - SISTEMA DE DISEÃ‘O ===== */

.mission-briefing-container {
    max-width: 500px;
    width: 90%;
    max-height: 85vh;
    margin: 0 auto;
    padding: 40px 32px;
    overflow-y: auto;
    overflow-x: hidden;
    animation: fadeIn 0.3s ease;
}

@keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
}

.mission-number {
    font-size: 14px;
    font-weight: 600;
    color: #a0a0a0;
    text-transform: uppercase;
    letter-spacing: 1px;
    margin-bottom: 24px;
}

.mission-brief-text {
    color: #e0e0e0;
    margin-bottom: 32px;
    line-height: 1.6;
    font-size: 16px;
}

.mission-objectives-list {
    background: rgba(255, 255, 255, 0.03);
    padding: 16px 20px;
    border-left: 3px solid #4ecca3;
    margin-bottom: 40px;
    border-radius: 4px;
    color: #e0e0e0;
    font-size: 14px;
    line-height: 1.8;
}

/* ===== MISSION RESULT - SISTEMA DE DISEÃ‘O ===== */

.mission-result-container {
    max-width: 500px;
    width: 90%;
    max-height: 85vh;
    margin: 0 auto;
    padding: 60px 40px;
    overflow-y: auto;
    overflow-x: hidden;
    text-align: center;
    animation: fadeIn 0.3s ease;
}

.result-icon {
    width: 64px;
    height: 64px;
    margin: 0 auto 24px;
    background: rgba(78, 204, 163, 0.15);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 32px;
    color: #4ecca3;
    border: 2px solid rgba(78, 204, 163, 0.3);
}

.result-title {
    font-size: 24px;
    font-weight: 600;
    color: #e0e0e0;
    margin: 0 0 40px 0;
    letter-spacing: 0.3px;
}

.result-title.failure {
    color: #e74c3c;
}

.result-icon.failure {
    background: rgba(231, 76, 60, 0.15);
    color: #e74c3c;
    border-color: rgba(231, 76, 60, 0.3);
}

.result-actions {
    display: flex;
    flex-direction: column;
    gap: 16px;
}

/* ===== BOTONES DE ACCIÃ“N - SISTEMA CONSISTENTE ===== */

.action-btn {
    width: 75%; /* -25% del ancho original */
    margin: 0 auto; /* Centrar horizontalmente */
    padding: 24px;
    font-size: 18px;
    font-weight: 600;
    font-family: 'Courier New', monospace;
    border: none;
    border-radius: 0;
    cursor: pointer;
    transition: all 0.2s ease;
    letter-spacing: 0.3px;
    background: none;
    background-image: url('assets/sprites/ui/UIFrames/medium_bton.png');
    background-size: 100% 100%;
    background-repeat: no-repeat;
    background-position: center;
}

.action-btn.primary {
    color: #fff;
    text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
}

.action-btn.primary:hover {
    filter: brightness(1.2);
    transform: translateY(-2px);
}

.action-btn.secondary {
    color: #ccc;
    filter: brightness(0.8);
}

.action-btn.secondary:hover {
    filter: brightness(1.1);
    color: #fff;
}

#mission-stats {
    margin: 30px 0;
}

.stat-item {
    display: flex;
    justify-content: space-between;
    padding: 12px;
    margin: 8px 0;
    background: rgba(0, 0, 0, 0.3);
    border-radius: 5px;
    border-left: 3px solid #4ecca3;
}

.stat-label {
    color: #aaa;
    font-size: 1.1em;
}

.stat-value {
    color: #4ecca3;
    font-size: 1.2em;
    font-weight: bold;
}

#unlocks {
    margin: 20px 0;
    padding: 15px;
    background: rgba(78, 204, 163, 0.1);
    border: 2px solid #4ecca3;
    border-radius: 8px;
    display: none;
}

#unlocks.show {
    display: block;
}

#upgrade-options {
    display: flex;
    flex-direction: column;
    gap: 15px;
    margin: 20px 0;
}

.upgrade-card {
    background: rgba(255, 255, 255, 0.05);
    padding: 20px;
    border-radius: 10px;
    border: 2px solid #555;
    transition: all 0.3s ease;
}

.upgrade-card:hover {
    border-color: #4ecca3;
    transform: scale(1.02);
}

.upgrade-card h3 {
    color: #4ecca3;
    margin-bottom: 10px;
}

.upgrade-card p {
    color: #ccc;
    margin-bottom: 15px;
    line-height: 1.5;
}

.upgrade-cost {
    color: #f39c12;
    font-weight: bold;
    margin-bottom: 10px;
}

.upgrade-purchase-btn {
    width: 100%;
    padding: 12px;
    background: linear-gradient(135deg, #3498db, #2980b9);
    border: none;
    color: white;
    cursor: pointer;
    border-radius: 8px;
    font-family: inherit;
    font-weight: bold;
    transition: all 0.3s ease;
}

.upgrade-purchase-btn:hover {
    background: linear-gradient(135deg, #2980b9, #21618c);
}

.upgrade-purchase-btn:disabled {
    opacity: 0.5;
    cursor: not-allowed;
}

/* ===== TUTORIAL - SISTEMA DE DISEÃ‘O ===== */

.tutorial-panel {
    position: absolute;
    bottom: 24px;
    left: 24px;
    background: rgba(10, 14, 39, 0.95);
    padding: 0;
    border-radius: 12px;
    border: 1px solid rgba(255, 255, 255, 0.1);
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
    z-index: var(--z-game-hud);
    max-width: 360px;
    backdrop-filter: blur(10px);
}

.tutorial-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 16px 20px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

.tutorial-header h3 {
    font-size: 16px;
    font-weight: 600;
    color: #e0e0e0;
    margin: 0;
    letter-spacing: 0.3px;
}

.tutorial-close {
    background: none;
    border: none;
    color: #a0a0a0;
    font-size: 28px;
    line-height: 1;
    cursor: pointer;
    padding: 0;
    width: 24px;
    height: 24px;
    transition: color 0.2s ease;
}

.tutorial-close:hover {
    color: #fff;
}

.tutorial-content {
    padding: 16px 20px;
}

.tutorial-section {
    margin-bottom: 16px;
}

.tutorial-section:last-child {
    margin-bottom: 0;
}

.tutorial-instruction {
    margin: 8px 0;
    color: #e0e0e0;
    line-height: 1.5;
    font-size: 14px;
}

.tutorial-item {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 8px 0;
}

.tutorial-icon {
    font-size: 20px;
    width: 32px;
    text-align: center;
}

.tutorial-item strong {
    display: block;
    color: #e0e0e0;
    font-size: 14px;
    margin-bottom: 2px;
}

.tutorial-item p {
    margin: 0;
    color: #a0a0a0;
    font-size: 12px;
    line-height: 1.4;
}

/* Scrollbar styling */
::-webkit-scrollbar {
    width: 8px;
}

::-webkit-scrollbar-track {
    background: rgba(0, 0, 0, 0.3);
}

::-webkit-scrollbar-thumb {
    background: #4ecca3;
    border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
    background: #3dbb8f;
}

/* ===== EDITOR DE MAPAS - REDISEÃ‘O UX ===== */

/* TOOLBAR HORIZONTAL SUPERIOR */
.editor-toolbar {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    height: 56px;
    background: #1a1a1a;
    border-bottom: 1px solid #333;
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0 16px;
    z-index: var(--z-modals);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
}

.editor-toolbar.hidden {
    display: none;
}

.editor-toolbar-section {
    display: flex;
    align-items: center;
    gap: 8px;
}

.editor-toolbar-title {
    font-size: 15px;
    font-weight: 500;
    color: #fff;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
}

.editor-toolbar-divider {
    width: 1px;
    height: 32px;
    background: #333;
    margin: 0 4px;
}

.editor-toolbar-tools {
    flex: 1;
    justify-content: center;
}

.editor-toolbar-actions {
    gap: 4px;
}

/* BOTONES DE TOOLBAR */
.editor-tool-btn {
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 8px 12px;
    background: transparent;
    border: 1px solid transparent;
    border-radius: 6px;
    color: #ccc;
    font-size: 13px;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    cursor: pointer;
    transition: all 0.15s ease;
}

.editor-tool-btn:hover {
    background: rgba(255, 255, 255, 0.05);
    color: #fff;
}

.editor-tool-btn.active {
    background: rgba(66, 133, 244, 0.15);
    border-color: #4285f4;
    color: #4285f4;
}

.editor-tool-btn .tool-icon {
    font-size: 16px;
}

.editor-tool-btn .tool-label {
    font-weight: 500;
}

/* Botones especÃ­ficos */
.editor-tool-back {
    color: #999;
}

.editor-tool-back:hover {
    color: #fff;
}

.editor-tool-toggle.active {
    background: rgba(66, 133, 244, 0.15);
    border-color: #4285f4;
    color: #4285f4;
}

.editor-tool-danger:hover {
    background: rgba(234, 67, 53, 0.15);
    color: #ea4335;
}

.editor-tool-primary {
    background: #4285f4;
    color: #fff;
    font-weight: 500;
}

.editor-tool-primary:hover {
    background: #5a95f5;
}

.editor-tool-success {
    background: #34a853;
    color: #fff;
    font-weight: 500;
}

.editor-tool-success:hover {
    background: #46b866;
}

/* PANEL LATERAL DERECHO */
.editor-panel-side {
    position: fixed;
    top: 56px;
    right: 0;
    width: 300px;
    height: calc(100vh - 56px);
    background: #1e1e1e;
    border-left: 1px solid #333;
    z-index: var(--z-modals);
    display: flex;
    flex-direction: column;
    transition: transform 0.2s ease;
    box-shadow: -2px 0 8px rgba(0, 0, 0, 0.3);
}

.editor-panel-side.hidden {
    display: none;
}

.editor-panel-side.collapsed {
    transform: translateX(300px);
}

.editor-panel-header {
    padding: 16px;
    border-bottom: 1px solid #333;
}

.editor-panel-header h3 {
    margin: 0;
    font-size: 14px;
    font-weight: 500;
    color: #fff;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
}

.editor-panel-content {
    flex: 1;
    overflow-y: auto;
    padding: 16px;
}

/* FORMULARIOS */
.editor-form-group {
    margin-bottom: 16px;
}

.editor-form-group label {
    display: block;
    font-size: 12px;
    font-weight: 500;
    color: #999;
    margin-bottom: 6px;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
}

.editor-form-group input,
.editor-form-group textarea {
    width: 100%;
    padding: 8px 10px;
    background: #2a2a2a;
    border: 1px solid #3a3a3a;
    border-radius: 4px;
    color: #fff;
    font-size: 13px;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    transition: border-color 0.15s ease;
}

.editor-form-group input:focus,
.editor-form-group textarea:focus {
    outline: none;
    border-color: #4285f4;
}

.editor-form-group textarea {
    resize: vertical;
    min-height: 60px;
}

/* Ajuste canvas cuando editor estÃ¡ activo */
body:has(.editor-toolbar:not(.hidden)) #game-container {
    padding-top: 56px;
}

body:has(.editor-toolbar:not(.hidden)) #main-game {
    height: calc(100vh - 56px);
}

/* Divider en formulario del editor */
.editor-form-divider {
    height: 1px;
    background: #333;
    margin: 16px 0;
}

.editor-form-section h4 {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
}

/* Lista de mejoras */
.editor-upgrades-list {
    display: flex;
    flex-direction: column;
    gap: 8px;
    max-height: 200px;
    overflow-y: auto;
}

.editor-upgrade-checkbox {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 6px 8px;
    background: #2a2a2a;
    border: 1px solid #3a3a3a;
    border-radius: 4px;
    cursor: pointer;
    transition: all 0.15s ease;
    position: relative;
}

.editor-upgrade-checkbox:hover {
    background: #333;
    border-color: #4285f4;
}

.editor-upgrade-checkbox input[type="checkbox"] {
    width: 16px;
    height: 16px;
    cursor: pointer;
    flex-shrink: 0;
}

.editor-upgrade-checkbox .upgrade-name {
    font-size: 12px;
    color: #ccc;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    flex: 1;
}

.editor-upgrade-checkbox .upgrade-info-icon {
    font-size: 14px;
    color: #666;
    cursor: help;
    flex-shrink: 0;
    transition: color 0.15s ease;
}

.editor-upgrade-checkbox:hover .upgrade-info-icon {
    color: #4285f4;
}

.editor-upgrade-checkbox:has(input:checked) {
    background: rgba(66, 133, 244, 0.1);
    border-color: #4285f4;
}

.editor-upgrade-checkbox:has(input:checked) .upgrade-name {
    color: #4285f4;
    font-weight: 500;
}

.editor-upgrade-checkbox:has(input:checked) .upgrade-info-icon {
    color: #4285f4;
}
/* ===== PANTALLA DE CARGA ===== */

.loading-container {
    max-width: 500px;
    width: 90%;
    text-align: center;
    animation: fadeIn 0.3s ease;
}

/* Pantalla "Press to Continue" */
.press-to-continue-container {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 100%;
    height: 100%;
    cursor: pointer;
}

.press-to-continue-text {
    font-size: 24px;
    color: white;
    text-align: center;
    animation: pulse 2s ease-in-out infinite;
}

@keyframes pulse {
    0%, 100% {
        opacity: 0.6;
    }
    50% {
        opacity: 1;
    }
}

.loading-title {
    font-size: 32px;
    font-weight: 700;
    color: #4ecca3;
    margin-bottom: 40px;
    letter-spacing: 1px;
    text-shadow: 0 2px 10px rgba(78, 204, 163, 0.3);
}

.loading-spinner {
    width: 60px;
    height: 60px;
    margin: 0 auto 30px;
    border: 4px solid rgba(78, 204, 163, 0.2);
    border-top: 4px solid #4ecca3;
    border-radius: 50%;
    animation: spin 1s linear infinite;
}

@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

.loading-bar-container {
    width: 100%;
    height: 8px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 4px;
    overflow: hidden;
    margin-bottom: 20px;
    box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.3);
}

.loading-bar-fill {
    height: 100%;
    background: linear-gradient(90deg, #4ecca3 0%, #5ef3b0 100%);
    border-radius: 4px;
    width: 0%;
    transition: width 0.3s ease;
    box-shadow: 0 0 10px rgba(78, 204, 163, 0.5);
}

.loading-text {
    font-size: 16px;
    color: #a0a0a0;
    margin-bottom: 10px;
    letter-spacing: 0.5px;
}

.loading-percentage {
    font-size: 24px;
    font-weight: 600;
    color: #4ecca3;
    letter-spacing: 1px;
}

/* ===== MENÃš DE OPCIONES ===== */
.options-menu {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.8);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: var(--z-modals);
}

.options-content {
    background: linear-gradient(135deg, #2d4a2d, #1a3a1a);
    border: 3px solid #4a5d23;
    border-radius: 10px;
    padding: 30px;
    min-width: 300px; /* -25% (400px â†’ 300px) */
    max-width: 375px; /* -25% (500px â†’ 375px) */
    box-shadow: 0 0 20px rgba(0, 0, 0, 0.7);
}

.options-content h2 {
    color: #ffffff;
    text-align: center;
    margin-bottom: 30px;
    font-size: 24px;
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
}

.volume-control {
    margin-bottom: 25px;
}

.volume-control label {
    display: block;
    color: #ffffff;
    font-size: 16px;
    margin-bottom: 10px;
    font-weight: bold;
}

.slider-container {
    display: flex;
    align-items: center;
    gap: 15px;
}

.volume-slider {
    flex: 1;
    height: 8px;
    background: rgba(74, 93, 35, 0.3);
    border-radius: 4px;
    outline: none;
    -webkit-appearance: none;
    appearance: none;
}

.volume-slider::-webkit-slider-thumb {
    -webkit-appearance: none;
    appearance: none;
    width: 20px;
    height: 20px;
    background: #4a5d23;
    border-radius: 50%;
    cursor: pointer;
    border: 2px solid #ffffff;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
}

.volume-slider::-webkit-slider-thumb:hover {
    background: #5a6d33;
    transform: scale(1.1);
}

.volume-slider::-moz-range-thumb {
    width: 20px;
    height: 20px;
    background: #4a5d23;
    border-radius: 50%;
    cursor: pointer;
    border: 2px solid #ffffff;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
}

.volume-label {
    color: #ffffff;
    font-size: 14px;
    font-weight: bold;
    min-width: 50px;
    text-align: center;
    background: rgba(74, 93, 35, 0.5);
    padding: 5px 10px;
    border-radius: 4px;
    border: 1px solid #4a5d23;
}

.options-buttons {
    display: flex;
    gap: 15px;
    justify-content: center;
    margin-top: 30px;
}

.options-buttons .action-btn {
    padding: 12px 24px;
    font-size: 16px;
    min-width: 112px; /* -25% (150px â†’ 112.5px) */
}

/* ===== MENÃš DE ARSENAL ===== */
/* ===== MENÃš DE ARSENAL ===== */
.arsenal-container {
    max-width: 1600px; /* Aumentado de 1400px para mÃ¡s espacio */
    width: 98%; /* Aumentado de 95% para aprovechar mÃ¡s espacio */
    max-height: 85vh;
    margin: 0 auto;
    padding: 32px;
    overflow: hidden;
    position: relative;
    box-sizing: border-box;
    pointer-events: auto;
}

/* Arsenal usa z-index de pantallas (ScreenManager lo maneja) */
#arsenal-overlay {
    z-index: var(--z-screens);
}

/* Elementos clickeables especÃ­ficos del arsenal */
#arsenal-overlay .arsenal-item,
#arsenal-overlay .deck-item,
#arsenal-overlay .deck-item-remove,
#arsenal-overlay .menu-btn,
#arsenal-overlay .pagination-btn {
    pointer-events: auto;
}

.arsenal-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 24px;
    padding-bottom: 16px;
    border-bottom: 1px solid rgba(78, 204, 163, 0.2);
}

.arsenal-header-right {
    display: flex;
    align-items: center;
    gap: 16px;
}

.arsenal-title {
    font-size: 24px;
    font-weight: 600;
    color: #4ecca3;
    margin: 0;
    letter-spacing: 0.5px;
    flex: 1;
    text-align: center;
}

.arsenal-body {
    display: grid;
    grid-template-columns: 1fr 360px; /* Izquierda mÃ¡s ancha, derecha reducida para dar mÃ¡s espacio */
    gap: 32px;
    height: calc(85vh - 140px);
}

/* Responsive: Stack en mÃ³vil */
@media (max-width: 968px) {
    .arsenal-body {
        grid-template-columns: 1fr;
        gap: 24px;
        height: auto;
    }
    
    .arsenal-container {
        padding: 16px;
        overflow-y: auto;
    }
}

/* Aumentar gap en pantallas grandes */
@media (min-width: 1200px) {
    .arsenal-body {
        gap: 48px;
        grid-template-columns: 1fr 380px; /* Reducido para dar mÃ¡s espacio al panel izquierdo */
    }
}

/* ===== PANEL IZQUIERDO: ELEMENTOS DISPONIBLES ===== */
.arsenal-left-section {
    display: flex;
    flex-direction: column;
    gap: 12px;
    min-height: 0; /* Necesario para que el scroll funcione en grid */
    height: 100%; /* Ocupar toda la altura del grid */
}

.available-panel {
    display: flex;
    flex-direction: column;
    background: rgba(0, 0, 0, 0.85); /* Fondo negro placeholder (se sustituirÃ¡ con UIFrame) - alpha aumentado */
    border: 2px solid rgba(76, 175, 80, 0.6); /* Verde mÃ¡s visible */
    border-radius: 12px;
    padding: 20px 20px 20px 20px; /* Padding uniforme */
    overflow: hidden;
    flex: 1; /* Ocupar el espacio disponible en arsenal-left-section */
    min-height: 0; /* Necesario para que el scroll funcione */
    width: 100%; /* Asegurar que ocupe todo el ancho disponible */
    box-sizing: border-box;
}

/* ðŸ†• NUEVO: Tabs para Unidades / Disciplinas */
.arsenal-tabs {
    display: flex;
    gap: 0;
    margin-bottom: 16px;
    border-bottom: 2px solid rgba(76, 175, 80, 0.3);
}

.arsenal-tab {
    flex: 1;
    padding: 12px 20px;
    background: transparent;
    border: none;
    border-bottom: 3px solid transparent;
    color: rgba(255, 255, 255, 0.6);
    font-size: 16px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    cursor: pointer;
    transition: all 0.3s ease;
    position: relative;
    bottom: -2px; /* Alinear con el borde inferior del contenedor */
}

.arsenal-tab:hover {
    color: rgba(255, 255, 255, 0.9);
    background: rgba(255, 255, 255, 0.05);
}

.arsenal-tab.active {
    color: #66bb6a;
    border-bottom-color: #66bb6a;
    background: rgba(76, 175, 80, 0.1);
}

.arsenal-tab:focus {
    outline: none;
}

/* DEPRECATED: Ya no se usa el tÃ­tulo directo, ahora son tabs */
.available-panel .panel-title {
    display: none; /* Oculto porque ahora usamos tabs */
    font-size: 18px;
    font-weight: 700;
    color: #66bb6a;
    margin: 0 0 16px 0;
    padding-bottom: 8px;
    border-bottom: 2px solid rgba(76, 175, 80, 0.6); /* Verde mÃ¡s visible - alpha aumentado */
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.available-panel .arsenal-content {
    flex: 1;
    overflow-y: auto;
    overflow-x: hidden;
    padding-right: 0; /* Sin padding derecho para eliminar gap */
    min-height: 0; /* Permite que el flex funcione correctamente */
    width: 100%; /* Asegurar que ocupe todo el ancho */
    box-sizing: border-box;
    margin-right: 0; /* Sin margen derecho */
}

/* Ocultar scrollbar pero mantener funcionalidad (opcional, para mÃ¡s espacio) */
.available-panel .arsenal-content::-webkit-scrollbar {
    width: 8px;
}

.available-panel .arsenal-content::-webkit-scrollbar-track {
    background: transparent;
}

.available-panel .arsenal-content::-webkit-scrollbar-thumb {
    background: rgba(76, 175, 80, 0.3);
    border-radius: 4px;
}

/* Texto informativo FUERA del panel, debajo */
.arsenal-help-text {
    padding: 8px 0;
    text-align: center;
    font-size: 14.3px; /* Aumentado un 10% desde 13px */
    color: rgba(102, 187, 106, 0.8);
    font-family: 'Courier New', monospace;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
}

.help-text-item {
    display: flex;
    align-items: center;
    gap: 6px;
}

.help-text-separator {
    margin: 0 4px;
}

.help-icon {
    width: 17.6px; /* Aumentado un 10% desde 16px */
    height: 17.6px; /* Aumentado un 10% desde 16px */
    image-rendering: pixelated;
    image-rendering: -moz-crisp-edges;
    image-rendering: crisp-edges;
    display: inline-block;
}

.help-icon-mirror {
    transform: scaleX(-1); /* Espejo horizontal */
}

/* Grid de cartas disponibles - 2x4 o similar */
.arsenal-items {
    display: grid;
    grid-template-columns: repeat(auto-fill, 207px); /* TamaÃ±o fijo: 207px de ancho */
    gap: 16px;
    padding-bottom: 80px; /* Espacio para paginaciÃ³n */
    justify-content: start; /* Alinear a la izquierda */
    width: 100%; /* Asegurar que ocupe todo el ancho disponible */
    max-width: 100%; /* No exceder el ancho del contenedor */
    box-sizing: border-box;
}

@media (min-width: 768px) and (max-width: 1199px) {
    .arsenal-items {
        grid-template-columns: repeat(auto-fill, 207px); /* TamaÃ±o fijo: 207px de ancho */
    }
}

@media (min-width: 1200px) {
    .arsenal-items {
        grid-template-columns: repeat(auto-fill, 207px); /* TamaÃ±o fijo: 207px de ancho */
    }
}

/* Carta individual en el grid */
.arsenal-item {
    background-color: rgba(255, 255, 255, 0.05);
    background-image: url('assets/sprites/ui/UIFrames/card_box.png');
    background-size: 100% 100%;
    background-repeat: no-repeat;
    background-position: center;
    padding: 0; /* Sin padding, el frame ya incluye el espacio */
    border-radius: 0; /* Sin border-radius, el frame ya tiene las esquinas redondeadas */
    border: none; /* Sin border, el frame ya incluye el borde */
    transition: all 0.2s ease;
    display: flex;
    flex-direction: column;
    gap: 0; /* Ajustar segÃºn necesidad */
    cursor: pointer;
    pointer-events: auto;
    width: 207px; /* Ancho fijo */
    height: 293px; /* Alto fijo */
    box-sizing: border-box;
}

.arsenal-item:hover:not(.in-deck) {
    filter: brightness(1.2);
    transform: translateY(-4px);
}

.arsenal-item-icon {
    width: 100%;
    height: 110px; /* Ajustado para el nuevo tamaÃ±o de carta */
    object-fit: contain;
    image-rendering: pixelated;
    image-rendering: -moz-crisp-edges;
    image-rendering: crisp-edges;
    background: rgba(0, 0, 0, 0.2);
    border-radius: 4px;
    padding: 8px;
    margin: 12px 12px 8px 12px; /* Padding interno para el contenido */
}

.arsenal-item-info {
    display: flex;
    flex-direction: column;
    gap: 6px;
    flex: 1;
    padding: 0 12px 12px 12px; /* Padding interno para el contenido */
}

.arsenal-item-name {
    font-size: 15px;
    font-weight: 600;
    color: #ffffff;
    margin: 0;
    text-align: center;
}

.arsenal-item-cost {
    font-size: 13px;
    font-weight: 700;
    color: #f39c12;
    margin: 0;
    text-align: center;
}

.arsenal-item-cost.free {
    color: #4ecca3;
}

/* MOSTRAR descripciÃ³n en tarjetas */
.arsenal-item-description {
    font-size: 12px;
    color: #cccccc;
    margin: 0;
    line-height: 1.4;
    text-align: center;
    flex: 1;
    display: -webkit-box;
    -webkit-line-clamp: 4;
    -webkit-box-orient: vertical;
    line-clamp: 4; /* Propiedad estÃ¡ndar para compatibilidad */
    overflow: hidden;
}

/* ðŸ†• NUEVO: Separador de disciplinas en el deck */
.disciplines-separator {
    font-size: 13px;
    font-weight: 700;
    color: #f39c12;
    text-transform: uppercase;
    margin: 16px 0 8px 0;
    padding: 8px 12px;
    background: rgba(243, 156, 18, 0.1);
    border-left: 3px solid #f39c12;
    letter-spacing: 0.5px;
}

/* ðŸ†• NUEVO: Disciplina en el deck-list (borde amarillo) */
.deck-item.discipline-deck-item {
    border-left: 4px solid #f39c12 !important;
    background: linear-gradient(90deg, rgba(243, 156, 18, 0.15) 0%, rgba(243, 156, 18, 0.05) 100%);
}

.deck-item.discipline-deck-item:hover {
    background: linear-gradient(90deg, rgba(243, 156, 18, 0.25) 0%, rgba(243, 156, 18, 0.1) 100%);
    border-left-color: #f39c12 !important;
}

.deck-item.discipline-deck-item .deck-item-name {
    color: #f39c12;
}

.deck-item.discipline-deck-item .deck-item-remove {
    background-color: rgba(243, 156, 18, 0.2);
}

.deck-item.discipline-deck-item .deck-item-remove:hover {
    background-color: #f39c12;
    color: #000;
}

/* Item ya aÃ±adido al mazo */
.arsenal-item.in-deck {
    opacity: 0.5;
    cursor: not-allowed;
    position: relative;
}

.arsenal-item.in-deck::after {
    content: 'âœ“';
    position: absolute;
    top: 12px;
    right: 12px;
    background: rgba(76, 175, 80, 1.0); /* Verde mÃ¡s visible - alpha aumentado */
    color: #000;
    width: 28px;
    height: 28px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 700;
    font-size: 18px;
}

/* PaginaciÃ³n en el panel izquierdo */
.arsenal-pagination {
    position: absolute;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    gap: 16px;
    align-items: center;
    background: rgba(0, 0, 0, 0.8);
    padding: 12px 24px;
    border-radius: 8px;
    border: 1px solid rgba(76, 175, 80, 0.3);
}

.pagination-btn {
    background: rgba(76, 175, 80, 0.2);
    border: 1px solid rgba(76, 175, 80, 0.5);
    color: #66bb6a;
    padding: 8px 16px;
    border-radius: 4px;
    cursor: pointer;
    font-size: 14px;
    font-weight: 700;
    transition: all 0.2s ease;
    display: flex;
    align-items: center;
    gap: 8px;
}

.pagination-btn:hover:not(:disabled) {
    background: rgba(76, 175, 80, 0.4);
    border-color: rgba(76, 175, 80, 0.8);
}

.pagination-btn:disabled {
    opacity: 0.3;
    cursor: not-allowed;
}

.pagination-info {
    color: #66bb6a;
    font-size: 14px;
    font-weight: 600;
    min-width: 80px;
    text-align: center;
}

/* ===== PANEL DERECHO: MAZO EQUIPADO ===== */
.deck-panel {
    display: flex;
    flex-direction: column;
    background: rgba(0, 0, 0, 0.85); /* Fondo negro placeholder (se sustituirÃ¡ con UIFrame) - alpha aumentado */
    border: 2px solid rgba(76, 175, 80, 0.6); /* Verde mÃ¡s visible */
    border-radius: 12px;
    padding: 20px;
    overflow: hidden;
}

.deck-panel .panel-title {
    font-size: 18px;
    font-weight: 700;
    color: #66bb6a; /* ðŸŽ¯ Verde en vez de azul */
    margin: 0;
    padding-bottom: 8px;
    border-bottom: 2px solid rgba(76, 175, 80, 0.6); /* Verde mÃ¡s visible - alpha aumentado */
    text-transform: uppercase;
    letter-spacing: 0.5px;
    display: flex;
    align-items: center;
    gap: 12px;
}

/* ðŸŽ¯ NUEVO: Header del panel derecho con tÃ­tulo y contador */
.deck-panel-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 16px;
}

/* ðŸ†• NUEVO: Header derecho con selector de destino */
.deck-header-right {
    display: flex;
    align-items: center;
    gap: 12px;
}

/* Selector de destino (Mazo/Banquillo) */
.deck-destination-selector {
    display: flex;
    gap: 4px;
    background: rgba(0, 0, 0, 0.3);
    border: 1px solid rgba(78, 204, 163, 0.3);
    border-radius: 4px;
    padding: 2px;
}

.destination-btn {
    background: transparent;
    border: none;
    color: rgba(255, 255, 255, 0.6);
    padding: 6px 12px;
    border-radius: 3px;
    cursor: pointer;
    font-size: 13px;
    font-weight: 600;
    transition: all 0.2s ease;
}

.destination-btn:hover {
    background: rgba(78, 204, 163, 0.1);
    color: rgba(255, 255, 255, 0.8);
}

.destination-btn.active {
    background: rgba(78, 204, 163, 0.3);
    color: #4ecca3;
    box-shadow: 0 0 8px rgba(78, 204, 163, 0.3);
}

/* Contador de unidades en el mazo */
.deck-counter {
    font-size: 16px;
    font-weight: 700;
    color: #66bb6a; /* ðŸŽ¯ Verde en vez de azul */
    padding: 6px 12px;
    background: rgba(76, 175, 80, 0.2); /* ðŸŽ¯ Verde en vez de azul */
    border: 1px solid rgba(76, 175, 80, 0.4); /* ðŸŽ¯ Verde en vez de azul */
    border-radius: 4px;
}

.deck-counter span {
    color: #ffffff;
}

/* Lista del mazo */
.deck-list {
    flex: 1;
    overflow-y: auto;
    overflow-x: hidden;
    min-height: 200px;
    padding-right: 8px;
}

.deck-empty {
    text-align: center;
    color: rgba(255, 255, 255, 0.5);
    font-size: 14px;
    padding: 60px 20px;
    font-style: italic;
}

/* Items del mazo - lista horizontal con botÃ³n X */
.deck-item {
    background-color: rgba(76, 175, 80, 0.2); /* Verde mÃ¡s visible - alpha aumentado */
    background-image: url('assets/sprites/ui/UIFrames/medium_bton.png');
    background-size: 100% 100%;
    background-repeat: no-repeat;
    background-position: center;
    padding: 12px 16px;
    margin-bottom: 10px;
    border-radius: 8px;
    border: 2px solid rgba(76, 175, 80, 0.5); /* Verde mÃ¡s visible - alpha aumentado */
    display: flex;
    align-items: center;
    gap: 12px;
    cursor: pointer;
    transition: all 0.2s ease;
    position: relative;
}

.deck-item:hover {
    filter: brightness(1.15);
    border-color: rgba(76, 175, 80, 0.7); /* Verde mÃ¡s visible en hover - alpha aumentado */
}

.deck-item-icon {
    width: 48px;
    height: 48px;
    flex-shrink: 0;
    object-fit: contain;
    image-rendering: pixelated;
    image-rendering: -moz-crisp-edges;
    image-rendering: crisp-edges;
    background: rgba(0, 0, 0, 0.2);
    border-radius: 4px;
    padding: 4px;
}

.deck-item-info {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 4px;
    min-width: 0;
}

.deck-item-name {
    font-size: 14px;
    font-weight: 600;
    color: #ffffff;
    margin: 0;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

.deck-item-cost {
    font-size: 12px;
    font-weight: 700;
    color: #f39c12;
}

/* BotÃ³n X para eliminar */
.deck-item-remove {
    background: rgba(244, 67, 54, 0.3);
    border: 2px solid rgba(244, 67, 54, 0.6);
    color: #ff5252;
    width: 32px;
    height: 32px;
    border-radius: 50%;
    cursor: pointer;
    font-size: 18px;
    font-weight: 700;
    transition: all 0.2s ease;
    flex-shrink: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    line-height: 1;
}

.deck-item-remove:hover {
    background: rgba(244, 67, 54, 0.5);
    border-color: rgba(244, 67, 54, 0.9);
    transform: scale(1.1);
}

/* Item bloqueado en el mazo (HQ) */
.deck-item-locked {
    opacity: 0.8;
    background-color: rgba(78, 204, 163, 0.15);
    border-color: rgba(78, 204, 163, 0.4);
}

.deck-item-locked .deck-item-remove {
    display: none;
}

/* Botones de acciÃ³n del mazo */
.deck-actions {
    display: flex;
    gap: 12px;
    margin-top: 16px;
    padding-top: 16px;
    border-top: 1px solid rgba(76, 175, 80, 0.3); /* ðŸŽ¯ Verde en vez de azul */
}

.deck-actions .menu-btn {
    flex: 1;
    padding: 12px 16px;
    font-size: 14px;
    font-weight: 700; /* Ya estÃ¡ en bold */
}

/* Asegurar que los botones Limpiar y Guardar estÃ©n en negrita */
#deck-clear-btn,
#deck-save-btn {
    font-weight: bold;
}

/* ===== ðŸ†• NUEVO: PANEL DE BANQUILLO ===== */
.bench-panel {
    margin-top: 20px;
    border-color: rgba(255, 152, 0, 0.4); /* Naranja para diferenciarlo del mazo */
}

.bench-panel .panel-title {
    color: #ff9800; /* Naranja */
    border-bottom-color: rgba(255, 152, 0, 0.3);
}

.bench-panel-header {
    cursor: pointer;
    user-select: none;
}

.bench-header-right {
    display: flex;
    align-items: center;
    gap: 12px;
}

.bench-toggle-btn {
    background: rgba(255, 152, 0, 0.2);
    border: 1px solid rgba(255, 152, 0, 0.4);
    color: #ff9800;
    width: 32px;
    height: 32px;
    border-radius: 4px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s ease;
    padding: 0;
}

.bench-toggle-btn:hover {
    background: rgba(255, 152, 0, 0.3);
    border-color: rgba(255, 152, 0, 0.6);
}

.bench-toggle-icon {
    font-size: 14px;
    transition: transform 0.2s ease;
    display: inline-block;
}

.bench-panel-content {
    margin-top: 16px;
    max-height: 300px;
    overflow-y: auto;
    overflow-x: hidden;
}

.bench-panel-content.collapsed {
    display: none;
}

/* Items del banquillo - similar a deck-item pero con color naranja */
.bench-item {
    background-color: rgba(255, 152, 0, 0.1);
    background-image: url('assets/sprites/ui/UIFrames/medium_bton.png');
    background-size: 100% 100%;
    background-repeat: no-repeat;
    background-position: center;
    padding: 12px 16px;
    margin-bottom: 10px;
    border-radius: 8px;
    border: 2px solid rgba(255, 152, 0, 0.3);
    display: flex;
    align-items: center;
    gap: 12px;
    cursor: pointer;
    transition: all 0.2s ease;
    position: relative;
}

.bench-item:hover {
    filter: brightness(1.15);
    border-color: rgba(255, 152, 0, 0.5);
}

/* Modo permutaciÃ³n: resaltar cartas del deck cuando se selecciona una del bench */
.swap-mode-active .deck-item {
    border-color: rgba(255, 152, 0, 0.5);
    background-color: rgba(255, 152, 0, 0.1);
}

.swap-mode-active .deck-item.swap-target {
    border-color: #ff9800;
    background-color: rgba(255, 152, 0, 0.2);
    box-shadow: 0 0 10px rgba(255, 152, 0, 0.5);
}

.swap-mode-active .bench-item.swap-selected {
    border-color: #ff9800;
    background-color: rgba(255, 152, 0, 0.3);
    box-shadow: 0 0 10px rgba(255, 152, 0, 0.7);
}

/* Eliminar panel de detalle - ya no se usa */
.arsenal-detail {
    display: none;
}

/* Mejoras de accesibilidad */
.arsenal-item:focus-visible,
.deck-item:focus-visible,
.deck-item-remove:focus-visible,
.pagination-btn:focus-visible {
    outline: 2px solid #4ecca3;
    outline-offset: 2px;
}

/* Scrollbar personalizado */
.available-panel .arsenal-content::-webkit-scrollbar,
.deck-list::-webkit-scrollbar {
    width: 8px;
}

.available-panel .arsenal-content::-webkit-scrollbar-track {
    background: rgba(76, 175, 80, 0.1);
    border-radius: 4px;
}

.available-panel .arsenal-content::-webkit-scrollbar-thumb {
    background: rgba(76, 175, 80, 0.4);
    border-radius: 4px;
}

.available-panel .arsenal-content::-webkit-scrollbar-thumb:hover {
    background: rgba(76, 175, 80, 0.6);
}

.deck-list::-webkit-scrollbar-track {
    background: rgba(76, 175, 80, 0.1); /* ðŸŽ¯ Verde en vez de azul */
    border-radius: 4px;
}

.deck-list::-webkit-scrollbar-thumb {
    background: rgba(76, 175, 80, 0.4); /* ðŸŽ¯ Verde en vez de azul */
    border-radius: 4px;
}

.deck-list::-webkit-scrollbar-thumb:hover {
    background: rgba(76, 175, 80, 0.6); /* ðŸŽ¯ Verde en vez de azul */
}

/* ===== MODAL DE SELECCIÃ“N DE MAZOS ===== */
/* Selector de mazos es un modal sobre el arsenal */
#deck-selector-overlay {
    z-index: calc(var(--z-modals) + 10); /* ðŸ†• FIX: Asegurar que estÃ© por encima de todo */
    pointer-events: none; /* Por defecto no captura eventos */
}

/* Modal de selector de deck - asegurar que capture eventos incluso dentro de ui-layer */
#deck-selector-overlay:not(.hidden) {
    pointer-events: auto !important; /* ðŸ†• FIX: Forzar pointer-events incluso dentro de ui-layer */
}

/* Asegurar que el contenedor del selector capture eventos */
#deck-selector-overlay:not(.hidden) .deck-selector-container {
    pointer-events: auto !important; /* ðŸ†• FIX: Forzar pointer-events */
}

/* Asegurar que los elementos dentro del selector capturen eventos */
#deck-selector-overlay:not(.hidden) * {
    pointer-events: auto !important; /* ðŸ†• FIX: Forzar pointer-events en todos los elementos */
}

/* Cuando el selector de mazos estÃ¡ visible, el arsenal no debe bloquear */
#arsenal-overlay:has(~ #deck-selector-overlay:not(.hidden)),
body:has(#deck-selector-overlay:not(.hidden)) #arsenal-overlay {
    pointer-events: none;
}

.deck-selector-container {
    background: linear-gradient(135deg, rgba(20, 25, 35, 0.98) 0%, rgba(15, 20, 30, 0.98) 100%);
    border: 2px solid rgba(78, 204, 163, 0.3);
    border-radius: 12px;
    padding: 32px;
    max-width: 600px;
    width: 90%;
    max-height: 80vh;
    display: flex;
    flex-direction: column;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
    position: relative;
    z-index: calc(var(--z-modals) + 1);
    pointer-events: auto !important; /* ðŸ†• FIX: Asegurar que el contenedor capture eventos */
}

.deck-selector-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 24px;
    padding-bottom: 16px;
    border-bottom: 1px solid rgba(78, 204, 163, 0.2);
}

.deck-selector-title {
    font-size: 24px;
    font-weight: 600;
    color: #4ecca3;
    margin: 0;
    letter-spacing: 0.5px;
}

.deck-selector-body {
    flex: 1;
    overflow-y: auto;
    overflow-x: hidden;
    min-height: 200px;
}

.deck-selector-list {
    display: flex;
    flex-direction: column;
    gap: 12px;
}

.deck-selector-item {
    background: rgba(33, 150, 243, 0.1);
    border: 1px solid rgba(33, 150, 243, 0.3);
    border-radius: 8px;
    padding: 16px;
    cursor: pointer;
    transition: all 0.2s ease;
    display: flex;
    align-items: center;
    justify-content: space-between;
}

.deck-selector-item:hover {
    background: rgba(33, 150, 243, 0.2);
    border-color: rgba(33, 150, 243, 0.5);
    transform: translateX(4px);
}

.deck-selector-item.selected {
    background: rgba(78, 204, 163, 0.2);
    border-color: rgba(78, 204, 163, 0.5);
}

.deck-selector-item-info {
    flex: 1;
}

.deck-selector-item-name {
    font-size: 18px;
    font-weight: 600;
    color: #ffffff;
    margin-bottom: 4px;
}

.deck-selector-item-meta {
    font-size: 12px;
    color: rgba(255, 255, 255, 0.6);
    display: flex;
    gap: 12px;
}

.deck-selector-item-badge {
    display: inline-block;
    padding: 2px 8px;
    background: rgba(78, 204, 163, 0.2);
    border: 1px solid rgba(78, 204, 163, 0.4);
    border-radius: 4px;
    font-size: 11px;
    color: #4ecca3;
    margin-left: 8px;
}

.deck-selector-item-actions {
    display: flex;
    gap: 8px;
}

.deck-selector-item-btn {
    background: rgba(33, 150, 243, 0.2);
    border: 1px solid rgba(33, 150, 243, 0.4);
    color: #42a5f5;
    padding: 6px 12px;
    border-radius: 4px;
    cursor: pointer;
    font-size: 12px;
    transition: all 0.2s ease;
}

.deck-selector-item-btn:hover {
    background: rgba(33, 150, 243, 0.3);
    border-color: rgba(33, 150, 243, 0.6);
}

.deck-selector-item-btn.delete {
    background: rgba(231, 76, 60, 0.2);
    border-color: rgba(231, 76, 60, 0.4);
    color: #e74c3c;
}

.deck-selector-item-btn.delete:hover {
    background: rgba(231, 76, 60, 0.3);
    border-color: rgba(231, 76, 60, 0.6);
}

.deck-selector-empty {
    text-align: center;
    color: rgba(255, 255, 255, 0.5);
    font-size: 14px;
    padding: 60px 20px;
    font-style: italic;
}

/* Scrollbar para el selector */
.deck-selector-body::-webkit-scrollbar {
    width: 8px;
}

.deck-selector-body::-webkit-scrollbar-track {
    background: rgba(78, 204, 163, 0.1);
    border-radius: 4px;
}

.deck-selector-body::-webkit-scrollbar-thumb {
    background: rgba(78, 204, 163, 0.4);
    border-radius: 4px;
}

.deck-selector-body::-webkit-scrollbar-thumb:hover {
    background: rgba(78, 204, 163, 0.6);
}

/* Ajuste para mÃ³vil */
@media (max-width: 967px) {
    .arsenal-items {
        grid-template-columns: repeat(2, 1fr);
    }
    
    .deck-panel {
        max-height: 400px;
    }
    
    .deck-selector-container {
        padding: 20px;
        max-width: 95%;
    }
}

/* ===== MODAL DE NOMBRE DE MAZO ===== */
#deck-name-modal-overlay {
    z-index: var(--z-modals);
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    display: none; /* Oculto por defecto */
    align-items: center;
    justify-content: center;
    background: rgba(0, 0, 0, 0.8);
    pointer-events: none;
}

/* Modal de nombre de deck - asegurar que capture eventos incluso dentro de ui-layer */
#deck-name-modal-overlay:not(.hidden) {
    display: flex;
    pointer-events: auto !important; /* ðŸ†• FIX: Forzar pointer-events incluso dentro de ui-layer */
    z-index: calc(var(--z-modals) + 10); /* ðŸ†• FIX: Asegurar que estÃ© por encima de todo */
}

/* Asegurar que el contenedor del modal capture eventos */
#deck-name-modal-overlay:not(.hidden) .deck-name-modal-container {
    pointer-events: auto !important; /* ðŸ†• FIX: Forzar pointer-events */
}

/* Asegurar que los elementos dentro del modal capturen eventos */
#deck-name-modal-overlay:not(.hidden) * {
    pointer-events: auto !important; /* ðŸ†• FIX: Forzar pointer-events en todos los elementos */
}

/* Ocultar el modal cuando tiene la clase hidden */
#deck-name-modal-overlay.hidden {
    display: none;
    pointer-events: none;
}

/* Contenedor del modal */
#deck-name-modal-overlay .deck-name-modal-container {
    position: relative;
    z-index: calc(var(--z-modals) + 1);
    pointer-events: auto; /* ðŸ†• FIX: Asegurar que el contenedor capture eventos */
}

.deck-name-modal-container {
    background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
    border: 2px solid #4ecca3;
    border-radius: 12px;
    padding: 30px;
    min-width: 400px;
    max-width: 500px;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
    pointer-events: auto; /* ðŸ†• FIX: Asegurar que el contenedor capture eventos */
}

.deck-name-modal-header {
    margin-bottom: 20px;
}

.deck-name-modal-title {
    color: #4ecca3;
    font-size: 24px;
    text-align: center;
    margin: 0;
}

.deck-name-modal-body {
    display: flex;
    flex-direction: column;
    gap: 20px;
}

.deck-name-input {
    width: 100%;
    padding: 12px 16px;
    background: rgba(0, 0, 0, 0.5);
    border: 2px solid #4ecca3;
    border-radius: 8px;
    color: #fff;
    font-family: 'Courier New', monospace;
    font-size: 16px;
    outline: none;
    transition: border-color 0.3s;
}

.deck-name-input:focus {
    border-color: #6ed4b8;
    box-shadow: 0 0 10px rgba(78, 204, 163, 0.3);
}

.deck-name-input::placeholder {
    color: rgba(255, 255, 255, 0.5);
}

.deck-name-modal-actions {
    display: flex;
    gap: 15px;
    justify-content: flex-end;
}

.deck-name-modal-actions .menu-btn {
    min-width: 100px;
}

@media (max-width: 768px) {
    .deck-name-modal-container {
        min-width: 90%;
        padding: 20px;
    }
    
    .deck-name-modal-title {
        font-size: 20px;
    }
    
    .deck-name-modal-actions {
        flex-direction: column;
    }
    
    .deck-name-modal-actions .menu-btn {
        width: 100%;
    }
}

/* ===== MODAL DE VISTA AMPLIADA DE CARTA ===== */
#card-zoom-overlay {
    z-index: var(--z-modals);
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    display: none;
    align-items: center;
    justify-content: center;
    background: rgba(0, 0, 0, 0.85);
    pointer-events: none;
}

/* Modal de carta ampliada - asegurar que capture eventos */
#card-zoom-overlay:not(.hidden) {
    display: flex;
    pointer-events: auto !important;
    z-index: calc(var(--z-modals) + 10);
}

#card-zoom-overlay.hidden {
    display: none;
    pointer-events: none;
}

.card-zoom-container {
    background: linear-gradient(135deg, rgba(20, 25, 35, 0.98) 0%, rgba(15, 20, 30, 0.98) 100%);
    border: 2px solid rgba(76, 175, 80, 0.4);
    border-radius: 16px;
    padding: 32px;
    max-width: 700px;
    width: 90%;
    max-height: 90vh;
    box-shadow: 0 12px 48px rgba(0, 0, 0, 0.7);
    position: relative;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 24px;
    pointer-events: auto;
}

.card-zoom-close {
    position: absolute;
    top: 16px;
    right: 16px;
    background: rgba(0, 0, 0, 0.6);
    border: 2px solid rgba(76, 175, 80, 0.4);
    border-radius: 50%;
    width: 40px;
    height: 40px;
    color: #66bb6a;
    font-size: 20px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s ease;
    z-index: 10;
}

.card-zoom-close:hover {
    background: rgba(76, 175, 80, 0.2);
    border-color: rgba(76, 175, 80, 0.6);
    transform: scale(1.1);
}

.card-zoom-canvas {
    width: 100%;
    max-width: 600px;
    height: auto;
    max-height: 400px;
    border: 2px solid rgba(76, 175, 80, 0.3);
    border-radius: 8px;
    background: rgba(0, 0, 0, 0.4);
    image-rendering: pixelated;
    image-rendering: -moz-crisp-edges;
    image-rendering: crisp-edges;
}

.card-zoom-info {
    width: 100%;
    text-align: center;
    display: flex;
    flex-direction: column;
    gap: 12px;
}

.card-zoom-name {
    font-size: 28px;
    font-weight: 700;
    color: #66bb6a;
    margin: 0;
    letter-spacing: 0.5px;
}

.card-zoom-cost {
    font-size: 18px;
    color: #66bb6a;
    margin: 0;
    font-weight: 600;
}

.card-zoom-desc {
    font-size: 16px;
    color: rgba(255, 255, 255, 0.9);
    margin: 0;
    line-height: 1.6;
    padding: 0 16px;
}

@media (max-width: 768px) {
    .card-zoom-container {
        padding: 24px;
        max-width: 95%;
    }
    
    .card-zoom-canvas {
        max-width: 100%;
        max-height: 300px;
    }
    
    .card-zoom-name {
        font-size: 24px;
    }
    
    .card-zoom-cost {
        font-size: 16px;
    }
    
    .card-zoom-desc {
        font-size: 14px;
    }
}

/* ===== SISTEMA DE NOTIFICACIONES ===== */
#notification-container {
    position: fixed;
    top: 20px;
    right: 20px;
    z-index: var(--z-modals);
    display: flex;
    flex-direction: column;
    gap: 10px;
    pointer-events: none;
    max-width: 400px;
}

.notification {
    background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
    border: 2px solid #4ecca3;
    border-radius: 8px;
    padding: 16px 20px;
    color: #fff;
    font-family: 'Courier New', monospace;
    font-size: 14px;
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.5);
    opacity: 0;
    transform: translateX(400px);
    transition: all 0.3s ease;
    pointer-events: auto;
    word-wrap: break-word;
}

.notification.show {
    opacity: 1;
    transform: translateX(0);
}

.notification-success {
    border-color: #4ecca3;
    background: linear-gradient(135deg, rgba(78, 204, 163, 0.1) 0%, rgba(61, 187, 143, 0.1) 100%);
}

.notification-error {
    border-color: #e74c3c;
    background: linear-gradient(135deg, rgba(231, 76, 60, 0.1) 0%, rgba(192, 57, 43, 0.1) 100%);
}

.notification-info {
    border-color: #3498db;
    background: linear-gradient(135deg, rgba(52, 152, 219, 0.1) 0%, rgba(41, 128, 185, 0.1) 100%);
}

@media (max-width: 768px) {
    #notification-container {
        top: 10px;
        right: 10px;
        left: 10px;
        max-width: none;
    }
    
    .notification {
        font-size: 12px;
        padding: 12px 16px;
    }
}